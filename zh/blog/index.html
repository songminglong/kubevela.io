<!doctype html>
<html lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="KubeVela Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="KubeVela Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5GLR1Y52M7"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5GLR1Y52M7",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="KubeVela" href="/zh/opensearch.xml"><title data-react-helmet="true">Blog | KubeVela</title><meta data-react-helmet="true" property="og:title" content="Blog | KubeVela"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" property="og:url" content="https://kubevela.io/zh/blog"><meta data-react-helmet="true" name="docsearch:language" content="zh"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><meta data-react-helmet="true" property="og:image" content="https://raw.githubusercontent.com/oam-dev/kubevela.io/main/docs/resources/KubeVela-03.png"><meta data-react-helmet="true" name="twitter:image" content="https://raw.githubusercontent.com/oam-dev/kubevela.io/main/docs/resources/KubeVela-03.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/zh/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://kubevela.io/zh/blog"><link data-react-helmet="true" rel="alternate" href="https://kubevela.io/blog" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://kubevela.io/zh/blog" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://kubevela.io/blog" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh/assets/css/styles.e34c5d79.css">
<link rel="preload" href="/zh/assets/js/runtime~main.56bf16d5.js" as="script">
<link rel="preload" href="/zh/assets/js/main.c258436b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><img src="/zh/img/logo.svg" alt="KubeVela" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh/img/logoDark.svg" alt="KubeVela" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">KubeVela</strong></a><a class="navbar__item navbar__link" href="/zh/docs/">æ–‡æ¡£</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/blog">åšå®¢</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/zh/docs/">v1.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/next/">Next</a></li><li><a class="dropdown__link" href="/zh/docs/">v1.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/blog" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh/blog" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li><li><a class="dropdown__link" href="/zh/blog/kubevela-official-documentation-translation-event">Help Us Translate</a></li></ul></div><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-githab-link"></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/zh/"><img src="/zh/img/logo.svg" alt="KubeVela" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh/img/logoDark.svg" alt="KubeVela" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">KubeVela</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/zh/docs/next/">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/">v1.0</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/zh/docs/">æ–‡æ¡£</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/zh/blog">åšå®¢</a></li><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/blog" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">English</a></li><li class="menu__list-item"><a href="/zh/blog" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li><li class="menu__list-item"><a class="menu__link" href="/zh/blog/kubevela-official-documentation-translation-event">Help Us Translate</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="menu__link header-githab-link"></a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-list-page"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_2ahu thin-scrollbar"><h3 class="sidebarItemTitle_2hhb">Recent posts</h3><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/extend-kubevela-by-cuelang-in-20-mins">å¦‚ä½•åœ¨ 20 åˆ†é’Ÿå†…ç»™ä½ çš„ K8s PaaS ä¸Šçº¿ä¸€ä¸ªæ–°åŠŸèƒ½</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/kubevela-jenkins-cicd">ä½¿ç”¨ Jenkins + KubeVela å®Œæˆåº”ç”¨çš„æŒç»­äº¤ä»˜</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/kubevela-official-documentation-translation-event">KubeVela å®˜æ–¹æ–‡æ¡£ç¿»è¯‘æ´»åŠ¨</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/kubevela-the-extensible-app-platform-based-on-open-application-model-and-kubernetes">KubeVela æ­£å¼å¼€æºï¼šä¸€ä¸ªé«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨å¹³å°ä¸æ ¸å¿ƒå¼•æ“</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/zh/blog/kubevela-performance-test">KubeVela Performance Test - Managing Massive Applications</a></li></ul></div></div><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/extend-kubevela-by-cuelang-in-20-mins">å¦‚ä½•åœ¨ 20 åˆ†é’Ÿå†…ç»™ä½ çš„ K8s PaaS ä¸Šçº¿ä¸€ä¸ªæ–°åŠŸèƒ½</a></h2><div class="margin-vert--md"><time datetime="2021-09-05T14:52:55.836Z" class="blogPostDate_fNvV">2021å¹´9æœˆ5æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/wonderflow" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/2173670?s=200&amp;v=4" alt="wonderflow"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/wonderflow" target="_blank" rel="noopener noreferrer">wonderflow</a></h4><small class="avatar__subtitle">OAM/KubeVela maintainer</small></div></div></header><div class="markdown"><blockquote><p>2020å¹´12æœˆ14æ—¥ 19:33, by @wonderflow</p></blockquote><p>ä¸Šä¸ªæœˆï¼Œ<a href="https://kubevela.io/#/blog/zh/kubevela-the-extensible-app-platform-based-on-open-application-model-and-kubernetes" target="_blank" rel="noopener noreferrer">KubeVela æ­£å¼å‘å¸ƒ</a>äº†ï¼Œ
ä½œä¸ºä¸€æ¬¾ç®€å•æ˜“ç”¨ä¸”é«˜åº¦å¯æ‰©å±•çš„åº”ç”¨ç®¡ç†å¹³å°ä¸æ ¸å¿ƒå¼•æ“ï¼Œå¯ä»¥è¯´æ˜¯å¹¿å¤§å¹³å°å·¥ç¨‹å¸ˆç”¨æ¥æ„å»ºè‡ªå·±çš„äº‘åŸç”Ÿ PaaS çš„ç¥å…µåˆ©å™¨ã€‚
é‚£ä¹ˆæœ¬æ–‡å°±ä»¥ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œè®²è§£ä¸€ä¸‹å¦‚ä½•åœ¨ 20 åˆ†é’Ÿå†…ï¼Œä¸ºä½ åŸºäº KubeVela çš„ PaaS â€œä¸Šçº¿â€œä¸€ä¸ªæ–°èƒ½åŠ›ã€‚</p><p>åœ¨æ­£å¼å¼€å§‹æœ¬æ–‡æ¡£çš„æ•™ç¨‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ æœ¬åœ°å·²ç»æ­£ç¡®<a href="https://kubevela.io/#/en/install" target="_blank" rel="noopener noreferrer">å®‰è£…äº† KubeVela</a> åŠå…¶ä¾èµ–çš„ K8s ç¯å¢ƒã€‚</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-æ‰©å±•çš„åŸºæœ¬ç»“æ„"></a>KubeVela æ‰©å±•çš„åŸºæœ¬ç»“æ„<a class="hash-link" href="#kubevela-æ‰©å±•çš„åŸºæœ¬ç»“æ„" title="Direct link to heading">#</a></h1><p>KubeVela çš„åŸºæœ¬æ¶æ„å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://kubevela-docs.oss-cn-beijing.aliyuncs.com/kubevela-extend.jpg" alt="image"></p><p>ç®€å•æ¥è¯´ï¼ŒKubeVela é€šè¿‡æ·»åŠ  <strong>Workload Type</strong> å’Œ <strong>Trait</strong> æ¥ä¸ºç”¨æˆ·æ‰©å±•èƒ½åŠ›ï¼Œå¹³å°çš„æœåŠ¡æä¾›æ–¹é€šè¿‡ Definition æ–‡ä»¶æ³¨å†Œå’Œæ‰©å±•ï¼Œå‘ä¸Šé€šè¿‡ Appfile é€å‡ºæ‰©å±•çš„åŠŸèƒ½ã€‚å®˜æ–¹æ–‡æ¡£ä¸­ä¹Ÿåˆ†åˆ«ç»™å‡ºäº†åŸºæœ¬çš„ç¼–å†™æµç¨‹ï¼Œå…¶ä¸­2ä¸ªæ˜¯Workloadçš„æ‰©å±•ä¾‹å­ï¼Œä¸€ä¸ªæ˜¯Traitçš„æ‰©å±•ä¾‹å­ï¼š</p><ul><li><a href="https://kubevela.io/#/en/platform-engineers/workload-type" target="_blank" rel="noopener noreferrer">OpenFaaS ä¸ºä¾‹çš„ Workload Type æ‰©å±•</a></li><li><a href="https://kubevela.io/#/en/platform-engineers/cloud-services" target="_blank" rel="noopener noreferrer">äº‘èµ„æº RDS ä¸ºä¾‹çš„ Workload Type æ‰©å±•</a></li><li><a href="https://kubevela.io/#/en/platform-engineers/trait" target="_blank" rel="noopener noreferrer">KubeWatch ä¸ºä¾‹çš„ Trait æ‰©å±•</a></li></ul><p>æˆ‘ä»¬ä»¥ä¸€ä¸ªå†…ç½®çš„ WorkloadDefinition ä¸ºä¾‹æ¥ä»‹ç»ä¸€ä¸‹ Definition æ–‡ä»¶çš„åŸºæœ¬ç»“æ„ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1alpha2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> WorkloadDefinition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">annotations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">definition.oam.dev/description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &quot;`Webservice` is a workload type to describe long</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">running</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> scalable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> containerized services that have a stable network endpoint to receive external network traffic from customers.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    If workload type is skipped for any service defined in Appfile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> it will be defaulted to `Web Service` type.&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">definitionRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> deployments.apps</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">extension</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token scalar string" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">      output: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        apiVersion: &quot;apps/v1&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        kind:       &quot;Deployment&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        spec: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            selector: matchLabels: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                &quot;app.oam.dev/component&quot;: context.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            template: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                metadata: labels: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                    &quot;app.oam.dev/component&quot;: context.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                spec: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                    containers: [{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        name:  context.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        if parameter[&quot;cmd&quot;] != _|_ {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                            command: parameter.cmd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        if parameter[&quot;env&quot;] != _|_ {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                            env: parameter.env</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        if context[&quot;config&quot;] != _|_ {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                            env: context.config</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        ports: [{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                            containerPort: parameter.port</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        }]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        if parameter[&quot;cpu&quot;] != _|_ {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                            resources: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                                limits:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                                    cpu: parameter.cpu</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                                requests:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                                    cpu: parameter.cpu</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                            }}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                    }]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            }}}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">      }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">      parameter: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        // +usage=Which image would you like to use for your service</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        // +short=i</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        image: string</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // +usage=Commands to run in the container</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">cmd?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // +usage=Which port do you want customer traffic sent to</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // +short=p</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token important">*80</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token plain"> int</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // +usage=Define arguments by using environment variables</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">env?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // +usage=Environment variable name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // +usage=The value of the environment variable</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">value?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            // +usage=Specifies a source the value of this var should come from</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">valueFrom?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                // +usage=Selects a key of a secret in the pod&#x27;s namespace</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token key atrule">secretKeyRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    // +usage=The name of the secret in the pod&#x27;s namespace to select from</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    // +usage=The key of the secret to select from. Must be a valid secret key</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token key atrule">key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // +usage=Number of CPU units for the service</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> like `0.5` (0.5 CPU core)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> `1` (1 CPU core)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">cpu?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä¹ä¸€çœ‹æŒºé•¿çš„ï¼Œå¥½åƒå¾ˆå¤æ‚ï¼Œä½†æ˜¯ä¸è¦ç€æ€¥ï¼Œå…¶å®ç»†çœ‹ä¹‹ä¸‹å®ƒåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p><ul><li>ä¸å«æ‰©å±•å­—æ®µçš„ Definition æ³¨å†Œéƒ¨åˆ†ã€‚</li><li>ä¾› Appfile ä½¿ç”¨çš„æ‰©å±•æ¨¡æ¿ï¼ˆCUE Templateï¼‰éƒ¨åˆ† </li></ul><p>æˆ‘ä»¬æ‹†å¼€æ¥æ…¢æ…¢ä»‹ç»ï¼Œå…¶å®å­¦èµ·æ¥å¾ˆç®€å•ã€‚</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä¸å«æ‰©å±•å­—æ®µçš„-definition-æ³¨å†Œéƒ¨åˆ†"></a>ä¸å«æ‰©å±•å­—æ®µçš„ Definition æ³¨å†Œéƒ¨åˆ†<a class="hash-link" href="#ä¸å«æ‰©å±•å­—æ®µçš„-definition-æ³¨å†Œéƒ¨åˆ†" title="Direct link to heading">#</a></h1><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1alpha2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> WorkloadDefinition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">annotations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">definition.oam.dev/description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &quot;`Webservice` is a workload type to describe long</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">running</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> scalable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> containerized services that have a stable network endpoint to receive external network traffic from customers.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    If workload type is skipped for any service defined in Appfile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> it will be defaulted to `Web Service` type.&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">definitionRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> deployments.apps</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ä¸€éƒ¨åˆ†æ»¡æ‰“æ»¡ç®—11è¡Œï¼Œå…¶ä¸­æœ‰3è¡Œæ˜¯åœ¨ä»‹ç» <code>webservice</code>çš„åŠŸèƒ½ï¼Œ5è¡Œæ˜¯å›ºå®šçš„æ ¼å¼ã€‚åªæœ‰2è¡Œæ˜¯æœ‰ç‰¹å®šä¿¡æ¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">definitionRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> deployments.apps</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ä¸¤è¡Œçš„æ„æ€ä»£è¡¨äº†è¿™ä¸ªDefinitionèƒŒåç”¨çš„CRDåç§°æ˜¯ä»€ä¹ˆï¼Œå…¶æ ¼å¼æ˜¯ <code>&lt;resources&gt;.&lt;api-group&gt;</code>.äº†è§£ K8s çš„åŒå­¦åº”è¯¥çŸ¥é“ K8s ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯é€šè¿‡ <code>api-group</code>, <code>version</code> å’Œ <code>kind</code> å®šä½èµ„æºï¼Œè€Œ <code>kind</code> åœ¨ K8s restful API ä¸­å¯¹åº”çš„æ˜¯ <code>resources</code>ã€‚ä»¥å¤§å®¶ç†Ÿæ‚‰ <code>Deployment</code> å’Œ <code>ingress</code> ä¸ºä¾‹ï¼Œå®ƒçš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p><table><thead><tr><th>api-group</th><th>kind</th><th>version</th><th>resources</th></tr></thead><tbody><tr><td>apps</td><td>Deployment</td><td>v1</td><td>deployments</td></tr><tr><td>networking.k8s.io</td><td>Ingress</td><td>v1</td><td>ingresses</td></tr></tbody></table><blockquote><p>è¿™é‡Œè¡¥å……ä¸€ä¸ªå°çŸ¥è¯†ï¼Œä¸ºä»€ä¹ˆæœ‰äº† kind è¿˜è¦åŠ ä¸ª resources çš„æ¦‚å¿µå‘¢ï¼Ÿ
å› ä¸ºä¸€ä¸ª CRD é™¤äº† kind æœ¬èº«è¿˜æœ‰ä¸€äº›åƒ statusï¼Œreplica è¿™æ ·çš„å­—æ®µå¸Œæœ›è·Ÿ spec æœ¬èº«è§£è€¦å¼€æ¥åœ¨ restful API ä¸­å•ç‹¬æ›´æ–°ï¼Œ
æ‰€ä»¥ resources é™¤äº† kind å¯¹åº”çš„é‚£ä¸€ä¸ªï¼Œè¿˜ä¼šæœ‰ä¸€äº›é¢å¤–çš„ resourcesï¼Œå¦‚ Deployment çš„ status è¡¨ç¤ºä¸º <code>deployments/status</code>ã€‚</p></blockquote><p>æ‰€ä»¥ç›¸ä¿¡èªæ˜çš„ä½ å·²ç»æ˜ç™½äº†ä¸å« extension çš„æƒ…å†µä¸‹ï¼ŒDefinitionåº”è¯¥æ€ä¹ˆå†™äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ ¹æ® K8s çš„èµ„æºç»„åˆæ–¹å¼æ‹¼æ¥ä¸€ä¸‹ï¼Œåªè¦å¡«ä¸‹é¢ä¸‰ä¸ªå°–æ‹¬å·çš„ç©ºæ ¼å°±å¯ä»¥äº†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1alpha2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> WorkloadDefinition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;è¿™é‡Œå†™åç§°</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">definitionRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;è¿™é‡Œå†™resources</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">.&lt;è¿™é‡Œå†™api</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">group</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>é’ˆå¯¹è¿ç»´ç‰¹å¾æ³¨å†Œï¼ˆTraitDefinitionï¼‰ä¹Ÿæ˜¯è¿™æ ·ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1alpha2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> TraitDefinition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;è¿™é‡Œå†™åç§°</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">definitionRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;è¿™é‡Œå†™resources</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">.&lt;è¿™é‡Œå†™api</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">group</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ‰€ä»¥æŠŠ <code>Ingress</code> ä½œä¸º KubeVela çš„æ‰©å±•å†™è¿›å»å°±æ˜¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1alpha2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> TraitDefinition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">  ingress</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">definitionRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ingresses.networking.k8s.io</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>é™¤æ­¤ä¹‹å¤–ï¼ŒTraitDefinition ä¸­è¿˜å¢åŠ äº†ä¸€äº›å…¶ä»–åŠŸèƒ½æ¨¡å‹å±‚åŠŸèƒ½ï¼Œå¦‚ï¼š</p><ul><li><code>appliesToWorkloads</code>: è¡¨ç¤ºè¿™ä¸ª trait å¯ä»¥ä½œç”¨äºå“ªäº› Workload ç±»å‹ã€‚</li><li><code>conflictWith</code>ï¼š è¡¨ç¤ºè¿™ä¸ª trait å’Œå“ªäº›å…¶ä»–ç±»å‹çš„ trait æœ‰å†²çªã€‚</li><li><code>workloadRefPath</code>ï¼š è¡¨ç¤ºè¿™ä¸ª trait åŒ…å«çš„ workload å­—æ®µæ˜¯å“ªä¸ªï¼ŒKubeVela åœ¨ç”Ÿæˆ trait å¯¹è±¡æ—¶ä¼šè‡ªåŠ¨å¡«å……ã€‚
... </li></ul><p>è¿™äº›åŠŸèƒ½éƒ½æ˜¯å¯é€‰çš„ï¼Œæœ¬æ–‡ä¸­ä¸æ¶‰åŠä½¿ç”¨ï¼Œåœ¨åç»­çš„å…¶ä»–æ–‡ç« ä¸­æˆ‘ä»¬å†ç»™å¤§å®¶è¯¦ç»†ä»‹ç»ã€‚</p><p>æ‰€ä»¥åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å·²ç»æŒæ¡äº†ä¸€ä¸ªä¸å« extensions çš„åŸºæœ¬æ‰©å±•æ¨¡å¼ï¼Œè€Œå‰©ä¸‹éƒ¨åˆ†å°±æ˜¯å›´ç»• <a href="https://cuelang.org/" target="_blank" rel="noopener noreferrer">CUE</a> çš„æŠ½è±¡æ¨¡æ¿ã€‚</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä¾›-appfile-ä½¿ç”¨çš„æ‰©å±•æ¨¡æ¿ï¼ˆcue-templateï¼‰éƒ¨åˆ†"></a>ä¾› Appfile ä½¿ç”¨çš„æ‰©å±•æ¨¡æ¿ï¼ˆCUE Templateï¼‰éƒ¨åˆ†<a class="hash-link" href="#ä¾›-appfile-ä½¿ç”¨çš„æ‰©å±•æ¨¡æ¿ï¼ˆcue-templateï¼‰éƒ¨åˆ†" title="Direct link to heading">#</a></h1><p>å¯¹ CUE æœ¬èº«æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒè¿™ç¯‡<a href="https://wonderflow.info/posts/2020-12-15-cuelang-template/" target="_blank" rel="noopener noreferrer">CUE åŸºç¡€å…¥é—¨</a> å¤šåšä¸€äº›äº†è§£ï¼Œé™äºç¯‡å¹…æœ¬æ–‡å¯¹ CUE æœ¬èº«ä¸è¯¦ç»†å±•å¼€ã€‚</p><p>å¤§å®¶çŸ¥é“ KubeVela çš„ Appfile å†™èµ·æ¥å¾ˆç®€æ´ï¼Œä½†æ˜¯ K8s çš„å¯¹è±¡æ˜¯ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå¤æ‚çš„ YAMLï¼Œè€Œä¸ºäº†ä¿æŒç®€æ´çš„åŒæ—¶åˆä¸å¤±å¯æ‰©å±•æ€§ï¼ŒKubeVela æä¾›äº†ä¸€ä¸ªä»å¤æ‚åˆ°ç®€æ´çš„æ¡¥æ¢ã€‚
è¿™å°±æ˜¯ Definition ä¸­ CUE Template çš„ä½œç”¨ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cue-æ ¼å¼æ¨¡æ¿"></a>CUE æ ¼å¼æ¨¡æ¿<a class="hash-link" href="#cue-æ ¼å¼æ¨¡æ¿" title="Direct link to heading">#</a></h2><p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ª Deployment çš„ YAML æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä¸­å¾ˆå¤šå†…å®¹éƒ½æ˜¯å›ºå®šçš„æ¡†æ¶ï¼ˆæ¨¡æ¿éƒ¨åˆ†ï¼‰ï¼ŒçœŸæ­£éœ€è¦ç”¨æˆ·å¡«çš„å†…å®¹å…¶å®å°±å°‘é‡çš„å‡ ä¸ªå­—æ®µï¼ˆå‚æ•°éƒ¨åˆ†ï¼‰ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">meadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mytest</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mytest</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> a</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> b</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">app.oam.dev/component</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mytest</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">app.oam.dev/component</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mytest</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨ KubeVela ä¸­ï¼ŒDefinition æ–‡ä»¶çš„å›ºå®šæ ¼å¼å°±æ˜¯åˆ†ä¸º <code>output</code> å’Œ <code>parameter</code> ä¸¤éƒ¨åˆ†ã€‚å…¶ä¸­<code>output</code>ä¸­çš„å†…å®¹å°±æ˜¯â€œæ¨¡æ¿éƒ¨åˆ†â€ï¼Œè€Œ <code>parameter</code> å°±æ˜¯å‚æ•°éƒ¨åˆ†ã€‚</p><p>é‚£æˆ‘ä»¬æ¥æŠŠä¸Šé¢çš„ Deployment YAML æ”¹å†™æˆ Definition ä¸­æ¨¡æ¿çš„æ ¼å¼ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cue"><div tabindex="0" class="prism-code language-cue codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    apiVersion: &quot;apps/v1&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    kind:       &quot;Deployment&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    metadata: name: &quot;mytest&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        selector: matchLabels: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;app.oam.dev/component&quot;: &quot;mytest&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        template: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            metadata: labels: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;app.oam.dev/component&quot;: &quot;mytest&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            spec: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                containers: [{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    name:  &quot;mytest&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    image: &quot;nginx:v1&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env: [{name:&quot;a&quot;,value:&quot;b&quot;}]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }}}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ä¸ªæ ¼å¼è·Ÿ json å¾ˆåƒï¼Œäº‹å®ä¸Šè¿™ä¸ªæ˜¯ CUE çš„æ ¼å¼ï¼Œè€Œ CUE æœ¬èº«å°±æ˜¯ä¸€ä¸ª json çš„è¶…é›†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒCUEçš„æ ¼å¼åœ¨æ»¡è¶³ JSON è§„åˆ™çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€äº›ç®€ä¾¿è§„åˆ™ï¼Œ
ä½¿å…¶æ›´æ˜“è¯»æ˜“ç”¨ï¼š</p><ul><li>C è¯­è¨€çš„æ³¨é‡Šé£æ ¼ã€‚</li><li>è¡¨ç¤ºå­—æ®µåç§°çš„åŒå¼•å·åœ¨æ²¡æœ‰ç‰¹æ®Šç¬¦å·çš„æƒ…å†µä¸‹å¯ä»¥ç¼ºçœã€‚</li><li>å­—æ®µå€¼ç»“å°¾çš„é€—å·å¯ä»¥ç¼ºçœï¼Œåœ¨å­—æ®µæœ€åçš„é€—å·å†™äº†ä¹Ÿä¸ä¼šå‡ºé”™ã€‚</li><li>æœ€å¤–å±‚çš„å¤§æ‹¬å·å¯ä»¥çœç•¥ã€‚</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cue-æ ¼å¼çš„æ¨¡æ¿å‚æ•°--å˜é‡å¼•ç”¨"></a>CUE æ ¼å¼çš„æ¨¡æ¿å‚æ•°--å˜é‡å¼•ç”¨<a class="hash-link" href="#cue-æ ¼å¼çš„æ¨¡æ¿å‚æ•°--å˜é‡å¼•ç”¨" title="Direct link to heading">#</a></h2><p>ç¼–å†™å¥½äº†æ¨¡æ¿éƒ¨åˆ†ï¼Œè®©æˆ‘ä»¬æ¥æ„å»ºå‚æ•°éƒ¨åˆ†ï¼Œè€Œè¿™ä¸ªå‚æ•°å…¶å®å°±æ˜¯å˜é‡çš„å¼•ç”¨ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    apiVersion: &quot;apps/v1&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    kind:       &quot;Deployment&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        selector: matchLabels: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;app.oam.dev/component&quot;: parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        template: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            metadata: labels: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;app.oam.dev/component&quot;: parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            spec: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                containers: [{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }}}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¦‚ä¸Šé¢çš„è¿™ä¸ªä¾‹å­æ‰€ç¤ºï¼ŒKubeVela ä¸­çš„æ¨¡æ¿å‚æ•°å°±æ˜¯é€šè¿‡ <code>parameter</code> è¿™ä¸ªéƒ¨åˆ†æ¥å®Œæˆçš„ï¼Œè€Œ<code>parameter</code> æœ¬è´¨ä¸Šå°±æ˜¯ä½œä¸ºå¼•ç”¨ï¼Œæ›¿æ¢æ‰äº† <code>output</code> ä¸­çš„æŸäº›å­—æ®µã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®Œæ•´çš„-definition-ä»¥åŠåœ¨-appfile-ä½¿ç”¨"></a>å®Œæ•´çš„ Definition ä»¥åŠåœ¨ Appfile ä½¿ç”¨<a class="hash-link" href="#å®Œæ•´çš„-definition-ä»¥åŠåœ¨-appfile-ä½¿ç”¨" title="Direct link to heading">#</a></h2><p>äº‹å®ä¸Šï¼Œç»è¿‡ä¸Šé¢ä¸¤éƒ¨åˆ†çš„ç»„åˆï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥å†™å‡ºä¸€ä¸ªå®Œæ•´çš„ Definition æ–‡ä»¶ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1alpha2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> WorkloadDefinition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">definitionRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> deployments.apps</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">extension</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token scalar string" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        parameter: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            name: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        output: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            apiVersion: &quot;apps/v1&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            kind:       &quot;Deployment&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">            spec: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                selector: matchLabels: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                    &quot;app.oam.dev/component&quot;: parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                template: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                    metadata: labels: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        &quot;app.oam.dev/component&quot;: parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                    spec: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        containers: [{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                            name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                            image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                        }]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">                    }}}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯ä»¥é¢„å…ˆåˆ†ä¸ºä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€éƒ¨åˆ†æ”¾å‰é¢çš„ yaml éƒ¨åˆ†ï¼Œå‡è®¾å‘½åä¸º <code>def.yaml</code> å¦‚ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">apiVersion: core.oam.dev/v1alpha2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kind: WorkloadDefinition</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">metadata:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  name: mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">spec:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  definitionRef:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: deployments.apps</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  extension:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    template: </span><span class="token operator">|</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¦ä¸€ä¸ªåˆ™æ”¾ cue æ–‡ä»¶ï¼Œå‡è®¾å‘½åä¸º <code>def.cue</code> ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    apiVersion: </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;apps/v1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    kind:       </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Deployment&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        selector: matchLabels: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;app.oam.dev/component&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        template: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            metadata: labels: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;app.oam.dev/component&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                containers: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å…ˆå¯¹ <code>def.cue</code> åšä¸€ä¸ªæ ¼å¼åŒ–ï¼Œæ ¼å¼åŒ–çš„åŒæ—¶ cue å·¥å…·æœ¬èº«ä¼šåšä¸€äº›æ ¡éªŒï¼Œä¹Ÿå¯ä»¥æ›´æ·±å…¥çš„<a href="https://wonderflow.info/posts/2020-12-15-cuelang-template/" target="_blank" rel="noopener noreferrer">é€šè¿‡ cue å‘½ä»¤åšè°ƒè¯•</a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">cue </span><span class="token function" style="color:rgb(80, 250, 123)">fmt</span><span class="token plain"> def.cue</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è°ƒè¯•å®Œæˆåï¼Œå¯ä»¥é€šè¿‡è„šæœ¬æŠŠè¿™ä¸ª yaml ç»„è£…ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">./hack/vela-templates/mergedef.sh def.yaml def.cue </span><span class="token operator">&gt;</span><span class="token plain"> mydeploy.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å†æŠŠè¿™ä¸ª yaml æ–‡ä»¶ apply åˆ° K8s é›†ç¾¤ä¸­ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl apply -f mydeploy.yaml</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">workloaddefinition.core.oam.dev/mydeploy created</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä¸€æ—¦æ–°èƒ½åŠ› <code>kubectl apply</code> åˆ°äº† Kubernetes ä¸­ï¼Œä¸ç”¨é‡å¯ï¼Œä¹Ÿä¸ç”¨æ›´æ–°ï¼ŒKubeVela çš„ç”¨æˆ·å¯ä»¥ç«‹åˆ»çœ‹åˆ°ä¸€ä¸ªæ–°çš„èƒ½åŠ›å‡ºç°å¹¶ä¸”å¯ä»¥ä½¿ç”¨äº†ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ vela worklaods</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Automatically discover capabilities successfully âœ… Add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> Update</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> Delete</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">TYPE        CATEGORY    DESCRIPTION</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">+mydeploy   workload    description not defined</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME        DESCRIPTION</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">mydeploy    description not defined</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨ Appfile ä¸­ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">extend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">mysvc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> crccheck/hello</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">world</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mysvc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ‰§è¡Œ <code>vela up</code> å°±èƒ½æŠŠè¿™ä¸ªè¿è¡Œèµ·æ¥äº†ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ vela up -f docs/examples/blog-extension/my-extend-app.yaml</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Parsing vela appfile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Loading templates </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Rendering configs </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">service</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">mysvc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Writing deploy config to </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.vela/deploy.yaml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Applying deploy configs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Checking </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> app has been deployed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">App has not been deployed, creating a new deployment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ… App has been deployed ğŸš€ğŸš€ğŸš€</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Port forward: vela port-forward my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             SSH: vela </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exec</span><span class="token plain"> my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">         Logging: vela logs my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      App status: vela status my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Service status: vela status my-extend-app --svc mysvc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬æ¥æŸ¥çœ‹ä¸€ä¸‹åº”ç”¨çš„çŠ¶æ€ï¼Œå·²ç»æ­£å¸¸è¿è¡Œèµ·æ¥äº†ï¼ˆ<code>HEALTHY Ready: 1/1</code>ï¼‰ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ vela status my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">About:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Name:         my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Namespace:    env-application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Created at:   </span><span class="token number">2020</span><span class="token plain">-12-15 </span><span class="token number">16</span><span class="token plain">:32:25.08233 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Updated at:   </span><span class="token number">2020</span><span class="token plain">-12-15 </span><span class="token number">16</span><span class="token plain">:32:25.08233 +0800 CST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Services:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  - Name: mysvc</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    HEALTHY Ready: </span><span class="token number">1</span><span class="token plain">/1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="definition-æ¨¡æ¿ä¸­çš„é«˜çº§ç”¨æ³•"></a>Definition æ¨¡æ¿ä¸­çš„é«˜çº§ç”¨æ³•<a class="hash-link" href="#definition-æ¨¡æ¿ä¸­çš„é«˜çº§ç”¨æ³•" title="Direct link to heading">#</a></h1><p>ä¸Šé¢æˆ‘ä»¬å·²ç»é€šè¿‡æ¨¡æ¿æ›¿æ¢è¿™ä¸ªæœ€åŸºæœ¬çš„åŠŸèƒ½ä½“éªŒäº†æ‰©å±• KubeVela çš„å…¨è¿‡ç¨‹ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå¯èƒ½ä½ è¿˜æœ‰ä¸€äº›æ¯”è¾ƒå¤æ‚çš„éœ€æ±‚ï¼Œå¦‚æ¡ä»¶åˆ¤æ–­ï¼Œå¾ªç¯ï¼Œå¤æ‚ç±»å‹ç­‰ï¼Œéœ€è¦ä¸€äº›é«˜çº§çš„ç”¨æ³•ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç»“æ„ä½“å‚æ•°"></a>ç»“æ„ä½“å‚æ•°<a class="hash-link" href="#ç»“æ„ä½“å‚æ•°" title="Direct link to heading">#</a></h2><p>å¦‚æœæ¨¡æ¿ä¸­æœ‰ä¸€äº›å‚æ•°ç±»å‹æ¯”è¾ƒå¤æ‚ï¼ŒåŒ…å«ç»“æ„ä½“å’ŒåµŒå¥—çš„å¤šä¸ªç»“æ„ä½“ï¼Œå°±å¯ä»¥ä½¿ç”¨ç»“æ„ä½“å®šä¹‰ã€‚</p><ol><li>å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ç±»å‹ï¼ŒåŒ…å«1ä¸ªå­—ç¬¦ä¸²æˆå‘˜ã€1ä¸ªæ•´å‹å’Œ1ä¸ªç»“æ„ä½“æˆå‘˜ã€‚</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">#Config: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name:  string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    value: int</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    other: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      key: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      value: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="2"><li>åœ¨å˜é‡ä¸­ä½¿ç”¨è¿™ä¸ªç»“æ„ä½“ç±»å‹ï¼Œå¹¶ä½œä¸ºæ•°ç»„ä½¿ç”¨ã€‚</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    config: [...#Config]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="3"><li>åŒæ ·çš„ç›®æ ‡ä¸­ä¹Ÿæ˜¯ä»¥å˜é‡å¼•ç”¨çš„æ–¹å¼ä½¿ç”¨ã€‚</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                containers: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env: parameter.config</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="4"><li>Appfile ä¸­çš„å†™æ³•å°±æ˜¯æŒ‰ç…§ parameter å®šä¹‰çš„ç»“æ„ç¼–å†™ã€‚</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">name: my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">services:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  mysvc:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    type: mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: crccheck/hello-world</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: mysvc</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    config:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - name: a</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      value: 1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      other:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        key: mykey</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        value: myvalue</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ¡ä»¶åˆ¤æ–­"></a>æ¡ä»¶åˆ¤æ–­<a class="hash-link" href="#æ¡ä»¶åˆ¤æ–­" title="Direct link to heading">#</a></h2><p>æœ‰æ—¶å€™æŸäº›å‚æ•°åŠ è¿˜æ˜¯ä¸åŠ å–å†³äºæŸä¸ªæ¡ä»¶ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name:   string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image:  string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    useENV: bool</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        containers: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> parameter.useENV </span><span class="token operator">==</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                env: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">name: </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;my-env&quot;</span><span class="token plain">, value: </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;my-value&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨ Appfile å°±æ˜¯å†™å€¼ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">name: my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">services:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  mysvc:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    type: mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: crccheck/hello-world</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: mysvc</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    useENV: true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¯ç¼ºçœå‚æ•°"></a>å¯ç¼ºçœå‚æ•°<a class="hash-link" href="#å¯ç¼ºçœå‚æ•°" title="Direct link to heading">#</a></h2><p>æœ‰äº›æƒ…å†µä¸‹å‚æ•°å¯èƒ½å­˜åœ¨ä¹Ÿå¯èƒ½ä¸å­˜åœ¨ï¼Œå³éå¿…å¡«ï¼Œè¿™ä¸ªæ—¶å€™ä¸€èˆ¬è¦é…åˆæ¡ä»¶åˆ¤æ–­ä½¿ç”¨ï¼Œå¯¹äºæŸä¸ªå­—æ®µä¸å­˜åœ¨çš„æƒ…å†µï¼Œåˆ¤æ–­æ¡ä»¶æ˜¯æ˜¯ <code>_variable != _|_</code>ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    config?: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token comment" style="color:rgb(98, 114, 164)">#Config]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        containers: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> parameter.config </span><span class="token operator">!=</span><span class="token plain"> _</span><span class="token operator">|</span><span class="token plain">_ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                config: parameter.config</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ç§æƒ…å†µä¸‹ Appfile çš„ config å°±éå¿…å¡«äº†ï¼Œå¡«äº†å°±æ¸²æŸ“ï¼Œæ²¡å¡«å°±ä¸æ¸²æŸ“ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é»˜è®¤å€¼"></a>é»˜è®¤å€¼<a class="hash-link" href="#é»˜è®¤å€¼" title="Direct link to heading">#</a></h2><p>å¯¹äºæŸäº›å‚æ•°å¦‚æœå¸Œæœ›è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå¯ä»¥é‡‡ç”¨è¿™ä¸ªå†™æ³•ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: *</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;nginx:v1&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        containers: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ä¸ªæ—¶å€™ Appfile å°±å¯ä»¥ä¸å†™ image è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨ &quot;nginx:v1&quot;ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">name: my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">services:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  mysvc:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    type: mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name: mysvc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¾ªç¯"></a>å¾ªç¯<a class="hash-link" href="#å¾ªç¯" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="map-ç±»å‹çš„å¾ªç¯"></a>Map ç±»å‹çš„å¾ªç¯<a class="hash-link" href="#map-ç±»å‹çš„å¾ªç¯" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name:  string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    env: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        containers: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            env: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> k, </span><span class="token function" style="color:rgb(80, 250, 123)">v</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> parameter.env </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    name:  k</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    value: </span><span class="token function" style="color:rgb(80, 250, 123)">v</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Appfile ä¸­çš„å†™æ³•ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">name: my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">services:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  mysvc:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    type: mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name:  &quot;mysvc&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: &quot;nginx&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    env:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      env1: value1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      env2: value2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ•°ç»„ç±»å‹çš„å¾ªç¯"></a>æ•°ç»„ç±»å‹çš„å¾ªç¯<a class="hash-link" href="#æ•°ç»„ç±»å‹çš„å¾ªç¯" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name:  string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    env: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">name:string,value:string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        containers: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            name:  parameter.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            env: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> _, </span><span class="token function" style="color:rgb(80, 250, 123)">v</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> parameter.env </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    name:  v.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    value: v.value</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Appfile ä¸­çš„å†™æ³•ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">name: my-extend-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">services:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  mysvc:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    type: mydeploy</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    name:  &quot;mysvc&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: &quot;nginx&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    env:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - name: env1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      value: value1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    - name: env2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      value: value2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-å†…ç½®çš„-context-å˜é‡"></a>KubeVela å†…ç½®çš„ <code>context</code> å˜é‡<a class="hash-link" href="#kubevela-å†…ç½®çš„-context-å˜é‡" title="Direct link to heading">#</a></h2><p>å¤§å®¶å¯èƒ½ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œæˆ‘ä»¬åœ¨ parameter ä¸­å®šä¹‰çš„ name æ¯æ¬¡åœ¨ Appfileä¸­ å®é™…ä¸Šå†™äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯åœ¨ services ä¸‹é¢ï¼ˆæ¯ä¸ªserviceéƒ½ä»¥åç§°åŒºåˆ†ï¼‰ï¼Œ
å¦ä¸€æ¬¡åˆ™æ˜¯åœ¨å…·ä½“çš„<code>name</code>å‚æ•°é‡Œé¢ã€‚äº‹å®ä¸Šè¿™é‡Œé‡å¤çš„ä¸åº”è¯¥ç”±ç”¨æˆ·å†å†™ä¸€éï¼Œæ‰€ä»¥ KubeVela ä¸­è¿˜å®šä¹‰äº†ä¸€ä¸ªå†…ç½®çš„ <code>context</code>ï¼Œé‡Œé¢å­˜æ”¾äº†ä¸€äº›é€šç”¨çš„ç¯å¢ƒä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚åº”ç”¨åç§°ã€ç§˜é’¥ç­‰ã€‚
ç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ context å°±ä¸éœ€è¦é¢å¤–å¢åŠ ä¸€ä¸ª <code>name</code> å‚æ•°äº†ï¼Œ KubeVela åœ¨è¿è¡Œæ¸²æŸ“æ¨¡æ¿çš„è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨ä¼ å…¥ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">parameter: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">output: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    spec: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        containers: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            name:  context.name</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            image: parameter.image</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-ä¸­çš„æ³¨é‡Šå¢å¼º"></a>KubeVela ä¸­çš„æ³¨é‡Šå¢å¼º<a class="hash-link" href="#kubevela-ä¸­çš„æ³¨é‡Šå¢å¼º" title="Direct link to heading">#</a></h2><p>KubeVela è¿˜å¯¹ cuelang çš„æ³¨é‡Šåšäº†ä¸€äº›æ‰©å±•ï¼Œæ–¹ä¾¿è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ä»¥åŠè¢« CLI ä½¿ç”¨ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain"> parameter: {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // +usage=Which image would you like to use for your service</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // +short=i</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        image: string</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        // +usage=Commands to run in the container</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        cmd?: [...string]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å…¶ä¸­ï¼Œ<code>+usgae</code> å¼€å¤´çš„æ³¨é‡Šä¼šå˜æˆå‚æ•°çš„è¯´æ˜ï¼Œ<code>+short</code> å¼€å¤´çš„æ³¨é‡Šåé¢åˆ™æ˜¯åœ¨ CLI ä¸­ä½¿ç”¨çš„ç¼©å†™ã€‚</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h1><p>æœ¬æ–‡é€šè¿‡å®é™…çš„æ¡ˆä¾‹å’Œè¯¦ç»†çš„è®²è¿°ï¼Œä¸ºä½ ä»‹ç»äº†åœ¨ KubeVela ä¸­æ–°å¢ä¸€ä¸ªèƒ½åŠ›çš„è¯¦ç»†è¿‡ç¨‹ä¸åŸç†ï¼Œä»¥åŠèƒ½åŠ›æ¨¡æ¿çš„ç¼–å†™æ–¹æ³•ã€‚</p><p>è¿™é‡Œä½ å¯èƒ½è¿˜æœ‰ä¸ªç–‘é—®ï¼Œå¹³å°ç®¡ç†å‘˜è¿™æ ·æ·»åŠ äº†ä¸€ä¸ªæ–°èƒ½åŠ›åï¼Œå¹³å°çš„ç”¨æˆ·åˆè¯¥æ€ä¹ˆèƒ½çŸ¥é“è¿™ä¸ªèƒ½åŠ›æ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿå…¶å®ï¼Œåœ¨ KubeVela ä¸­ï¼Œå®ƒä¸ä»…èƒ½æ–¹ä¾¿çš„æ·»åŠ æ–°èƒ½åŠ›ï¼Œ<strong>å®ƒè¿˜èƒ½è‡ªåŠ¨ä¸ºâ€œèƒ½åŠ›â€ç”Ÿæˆ Markdown æ ¼å¼çš„ä½¿ç”¨æ–‡æ¡£ï¼</strong> ä¸ä¿¡ï¼Œä½ å¯ä»¥çœ‹ä¸‹ KubeVela æœ¬èº«çš„å®˜æ–¹ç½‘ç«™ï¼Œæ‰€æœ‰åœ¨ <code>References/Capabilities</code>ç›®å½•ä¸‹èƒ½åŠ›ä½¿ç”¨è¯´æ˜æ–‡æ¡£ï¼ˆæ¯”å¦‚<a href="https://kubevela.io/#/en/developers/references/workload-types/webservice" target="_blank" rel="noopener noreferrer">è¿™ä¸ª</a>ï¼‰ï¼Œå…¨éƒ½æ˜¯æ ¹æ®æ¯ä¸ªèƒ½åŠ›çš„æ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆçš„å“¦ã€‚
æœ€åï¼Œæ¬¢è¿å¤§å®¶å†™ä¸€äº›æœ‰è¶£çš„æ‰©å±•åŠŸèƒ½ï¼Œæäº¤åˆ° KubeVela çš„<a href="https://github.com/oam-dev/catalog/tree/master/registry" target="_blank" rel="noopener noreferrer">ç¤¾åŒºä»“åº“</a>ä¸­æ¥ã€‚</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kubevela">kubevela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/kubevela-jenkins-cicd">ä½¿ç”¨ Jenkins + KubeVela å®Œæˆåº”ç”¨çš„æŒç»­äº¤ä»˜</a></h2><div class="margin-vert--md"><time datetime="2021-09-05T14:52:55.836Z" class="blogPostDate_fNvV">2021å¹´9æœˆ5æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="Da Yin, Yang Song"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">Da Yin, Yang Song</a></h4><small class="avatar__subtitle">KubeVela å›¢é˜Ÿ</small></div></div></header><div class="markdown"><p>KubeVela æ‰“é€šäº†åº”ç”¨ä¸åŸºç¡€è®¾æ–½ä¹‹é—´çš„äº¤ä»˜ç®¡æ§çš„å£å’ï¼Œç›¸è¾ƒäºåŸç”Ÿçš„ Kubernetes å¯¹è±¡ï¼ŒKubeVela çš„ Application æ›´å¥½åœ°ç®€åŒ–æŠ½è±¡äº†å¼€å‘è€…éœ€è¦å…³å¿ƒçš„é…ç½®ï¼Œå°†å¤æ‚çš„åŸºç¡€è®¾æ–½èƒ½åŠ›åŠç¼–æ’ç»†èŠ‚ç•™ç»™äº†å¹³å°å·¥ç¨‹å¸ˆã€‚è€Œ KubeVela çš„ apiserver åˆ™æ˜¯è¿›ä¸€æ­¥ä¸ºå¼€å‘è€…æä¾›äº†ä½¿ç”¨ HTTP Request ç›´æ¥æ“çºµ Application çš„é€”å¾„ï¼Œä½¿å¾—å¼€å‘è€…å³ä½¿æ²¡æœ‰ Kubernetes çš„ä½¿ç”¨ç»éªŒä¸é›†ç¾¤è®¿é—®æƒé™ä¹Ÿå¯ä»¥è½»æ¾éƒ¨ç½²è‡ªå·±çš„åº”ç”¨ã€‚</p><p>æœ¬æ–‡å°±ä»¥ç»å…¸çš„æŒç»­é›†æˆ (Continuous Integration) å·¥å…· Jenkins ä¸ºåŸºç¡€ï¼Œç®€å•ä»‹ç»å¦‚ä½•æ‰“é€ åŸºäº GitOps çš„åº”ç”¨æŒç»­äº¤ä»˜çš„â€œé«˜é€Ÿå…¬è·¯â€ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æŒç»­äº¤ä»˜é«˜é€Ÿå…¬è·¯"></a>æŒç»­äº¤ä»˜â€œé«˜é€Ÿå…¬è·¯â€<a class="hash-link" href="#æŒç»­äº¤ä»˜é«˜é€Ÿå…¬è·¯" title="Direct link to heading">#</a></h2><p>ä½œä¸ºåº”ç”¨å¼€å‘è€…çš„ä½ ï¼Œæ›´å¤šåœ°å…³å¿ƒè‡ªå·±çš„åº”ç”¨æ˜¯å¦æ­£å¸¸è¿ä½œï¼Œå¼€å‘æµç¨‹æ˜¯å¦ä¾¿æ·é«˜æ•ˆã€‚ä¸ºæ­¤ï¼Œåœ¨è¿™æ¡æŒç»­äº¤ä»˜çš„â€œé«˜é€Ÿå…¬è·¯â€ä¸Šï¼Œå°†ä¼šç”±ä»¥ä¸‹éƒ¨ä»¶ä¸ºä½ ä¿é©¾æŠ¤èˆªã€‚</p><ol><li>ä½ éœ€è¦ä¸€ä¸ª git ä»“åº“æ¥å­˜æ”¾åº”ç”¨ç¨‹åºä»£ç ã€æµ‹è¯•ä»£ç ï¼Œä»¥åŠæè¿° KubeVela Application çš„ YAML æ–‡ä»¶ã€‚</li><li>ä½ éœ€è¦ä¸€ä¸ªæŒç»­é›†æˆ (Continuous Integration) çš„å·¥å…·å¸®ä½ è‡ªåŠ¨åŒ–å®Œæˆç¨‹åºä»£ç çš„æµ‹è¯•ï¼Œå¹¶æ‰“åŒ…æˆé•œåƒä¸Šä¼ åˆ°ä»“åº“ä¸­ã€‚</li><li>ä½ éœ€è¦åœ¨ Kubernetes é›†ç¾¤ä¸Šå®‰è£… KubeVela å¹¶å¯ç”¨ apiserver åŠŸèƒ½ã€‚</li></ol><blockquote><p>ç›®å‰ KubeVela çš„ apiserver åœ¨æƒé™è®¤è¯æ–¹é¢ä»å¾…å®Œå–„ï¼Œåç»­å¯ç”¨ apiserver åå°†ä¼šåŠ å…¥æƒé™é…ç½®ç¯èŠ‚ã€‚</p></blockquote><p>æœ¬æ–‡çš„ä»‹ç»ä¸­é‡‡ç”¨äº† Github ä½œä¸º git ä»“åº“ï¼ŒJenkins ä½œä¸º CI å·¥å…·ï¼ŒDockerHub ä½œä¸ºé•œåƒä»“åº“ã€‚åº”ç”¨ç¨‹åºä»¥ä¸€ä¸ªç®€å•çš„ HTTP Server ä¸ºä¾‹ï¼Œæ•´ä¸ªæŒç»­äº¤ä»˜çš„æµç¨‹å¦‚ä¸‹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™æ¡æŒç»­äº¤ä»˜çš„â€œé«˜é€Ÿå…¬è·¯â€ä¸Šï¼Œå¼€å‘è€…åªéœ€è¦å…³å¿ƒåº”ç”¨çš„å¼€å‘å¹¶ä½¿ç”¨ Git è¿›è¡Œä»£ç ç‰ˆæœ¬çš„ç»´æŠ¤ï¼Œå³å¯è‡ªåŠ¨èµ°å®Œæµ‹è¯•æµç¨‹å¹¶éƒ¨ç½²åº”ç”¨åˆ° Kubernetes é›†ç¾¤ä¸­ã€‚</p><p><img alt="arch" src="/zh/assets/images/arch-53b2b1a473f0d637d4c7c0b9a81dd2b0.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éƒ¨ç½²ç¯å¢ƒ"></a>éƒ¨ç½²ç¯å¢ƒ<a class="hash-link" href="#éƒ¨ç½²ç¯å¢ƒ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="jenkins-ç¯å¢ƒ"></a>Jenkins ç¯å¢ƒ<a class="hash-link" href="#jenkins-ç¯å¢ƒ" title="Direct link to heading">#</a></h3><blockquote><p>æœ¬æ–‡é‡‡ç”¨äº† Jenkins ä½œä¸ºæŒç»­é›†æˆå·¥å…·ï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»– CI å·¥å…·ï¼Œå¦‚ TravisCI æˆ–è€… GitHub Actionã€‚</p></blockquote><p>é¦–å…ˆæ‚¨éœ€è¦å‡†å¤‡ä¸€ä»½ Jenkins ç¯å¢ƒæ¥éƒ¨ç½² CI æµæ°´çº¿ã€‚å®‰è£…ä¸åˆå§‹åŒ– Jenkins æµç¨‹å¯ä»¥å‚è§<a href="https://www.jenkins.io/doc/book/installing/linux/" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæœ¬æ–‡çš„ CI æµæ°´çº¿æ˜¯åŸºäº Docker åŠ GitHub çš„ï¼Œå› æ­¤åœ¨å®‰è£… Jenkins ä¹‹åè¿˜éœ€è¦å®‰è£…ç›¸å…³æ’ä»¶ (Dashboard &gt; Manage Jenkins &gt; Manage Plugins) ï¼ŒåŒ…æ‹¬ Pipelineã€HTTP Request Pluginã€Docker Pipelineã€Docker Pluginã€‚</p><p>æ­¤å¤–ï¼Œè¿˜éœ€è¦ä¸º Jenkins é…ç½® Docker çš„è¿è¡Œç¯å¢ƒ (Dashboard &gt; Manage Jenkins &gt; Configure System &gt; Docker Builder) ï¼Œå¦‚ Jenkins æ‰€åœ¨ç¯å¢ƒå·²ç»å®‰è£…äº† Dockerï¼Œå¯ä»¥å°† Docker URL é…ç½®ä¸º <code>unix:///var/run/docker.sock</code>ã€‚</p><p>ç”±äºåœ¨ CI æµæ°´çº¿è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿˜éœ€è¦å°†å®¹å™¨é•œåƒæ¨è‡³é•œåƒä»“åº“ï¼Œä¸ºæ­¤éœ€åœ¨ Jenkins çš„ Credential ä¸­å°†é•œåƒä»“åº“çš„è´¦æˆ·é…ç½®å¥½ (Dashboard &gt; Manage Jenkins &gt; Manage Credentials &gt; Add Credentials) ï¼Œæ¯”å¦‚å°† DockerHub çš„ç”¨æˆ·ååŠå¯†ç å­˜å…¥ã€‚</p><p><img alt="jenkins-credential" src="/zh/assets/images/jenkins-credential-52c71b3f3a886ec0596a29a2356ad291.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="github-ä»“åº“ç¯å¢ƒ"></a>GitHub ä»“åº“ç¯å¢ƒ<a class="hash-link" href="#github-ä»“åº“ç¯å¢ƒ" title="Direct link to heading">#</a></h3><blockquote><p>æœ¬æ–‡çš„ä»‹ç»é‡‡ç”¨äº† Github ä½œä¸ºä»£ç ä»“åº“ï¼Œå¼€å‘è€…è¿˜å¯ä»¥æ ¹æ®å„è‡ªçš„éœ€æ±‚ä¸å–œå¥½ï¼Œä½¿ç”¨å…¶ä»–ä»£ç ä»“åº“ï¼Œå¦‚ Gitlabã€‚</p></blockquote><p>ä¸ºä½¿æŒç»­é›†æˆå·¥å…· Jenkins èƒ½å¤Ÿè·å–åˆ° GitHub ä¸­çš„æ›´æ–°ï¼Œå¹¶å°†æµæ°´çº¿çš„è¿è¡ŒçŠ¶æ€åé¦ˆå› GitHubï¼Œéœ€è¦åœ¨ GitHub ä¸­å®Œæˆä»¥ä¸‹ä¸¤æ­¥æ“ä½œã€‚</p><ol><li><a href="https://github.com/settings/tokens/new" target="_blank" rel="noopener noreferrer">é…ç½®</a> Personal Access Tokenã€‚æ³¨æ„å°† <code>repo:status</code> å‹¾é€‰ï¼Œä»¥è·å¾—å‘ GitHub æ¨é€ Commit çŠ¶æ€çš„æƒé™ã€‚</li></ol><p><img alt="github-pat" src="/zh/assets/images/github-pat-a8de5950eaf01a6d416a869d70b189ac.png"></p><p>ç„¶ååœ¨ Jenkins çš„ Credential ä¸­åŠ å…¥ Secret Text ç±»å‹çš„ Credential å¹¶å°†ä¸Šè¿°çš„ GitHub çš„ Personal Access Token å¡«å…¥ã€‚</p><p><img alt="jenkins-secret-text" src="/zh/assets/images/jenkins-secret-text-0de6c324500b26a5bfb81520ff7eab2b.png"></p><p>æœ€åæ¥åˆ° Jenkins çš„ Dashboard &gt; Manage Jenkins &gt; Configure System &gt; GitHub ä¸­ç‚¹å‡» Add GitHub Server å¹¶å°†åˆšæ‰åˆ›å»ºçš„ Credential å¡«å…¥ã€‚å®Œæˆåå¯ä»¥ç‚¹å‡» Test connection æ¥éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ã€‚</p><p><img alt="jenkins-github" src="/zh/assets/images/jenkins-github-e99c47fab606f6c9c9f3f6f841840329.png"></p><ol start="2"><li>åœ¨ GitHub çš„ä»£ç ä»“åº“çš„è®¾å®šé‡Œæ·»åŠ  Webhookï¼Œå°† Jenkins çš„åœ°å€å¯¹åº”çš„ Webhook åœ°å€å¡«å…¥ï¼Œæ¯”å¦‚ <a href="http://my-jenkins.example.com/github-webhook/" target="_blank" rel="noopener noreferrer">http://my-jenkins.example.com/github-webhook/</a> ã€‚è¿™æ ·ï¼Œè¯¥ä»£ç ä»“åº“çš„æ‰€æœ‰ Push äº‹ä»¶æ¨é€åˆ° Jenkins ä¸­ã€‚</li></ol><p><img alt="github-webhook" src="/zh/assets/images/github-webhook-5579402b6bc37238d42842fd5d52fd02.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-ç¯å¢ƒ"></a>KubeVela ç¯å¢ƒ<a class="hash-link" href="#kubevela-ç¯å¢ƒ" title="Direct link to heading">#</a></h3><p>æ‚¨éœ€è¦åœ¨ Kubernetes é›†ç¾¤ä¸­å®‰è£… KubeVelaï¼Œå¹¶å¯ç”¨ apiserver åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒ<a href="/zh/docs/advanced-install#install-kubevela-with-apiserver">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç¼–å†™åº”ç”¨"></a>ç¼–å†™åº”ç”¨<a class="hash-link" href="#ç¼–å†™åº”ç”¨" title="Direct link to heading">#</a></h2><p>æœ¬æ–‡é‡‡ç”¨çš„åº”ç”¨æ˜¯ä¸€ä¸ªåŸºäº Golang è¯­è¨€ç¼–å†™çš„ç®€å•çš„ HTTP Serverã€‚åœ¨ä»£ç ä¸­ï¼Œå£°æ˜äº†ä¸€ä¸ªåå« <code>VERSION</code> çš„å¸¸é‡ï¼Œå¹¶åœ¨è®¿é—®è¯¥æœåŠ¡æ—¶æ‰“å°å‡ºæ¥ã€‚åŒæ—¶è¿˜é™„å¸¦ä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼Œç”¨æ¥æ ¡éªŒ <code>VERSION</code> çš„æ ¼å¼æ˜¯å¦ç¬¦åˆæ ‡å‡†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><div tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// main.go</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">package</span><span class="token plain"> main</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;net/http&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> VERSION </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.1.0-v1alpha1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">HandleFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r </span><span class="token operator">*</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token boolean">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">_</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fprintf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Version: %s\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ListenAndServe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;:8088&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><div tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// main_test.go</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">package</span><span class="token plain"> main</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;regexp&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;testing&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> verRegex </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">`^v?([0-9]+)(\.[0-9]+)?(\.[0-9]+)?`</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">`(-([0-9A-Za-z\-]+(\.[0-9A-Za-z\-]+)*))?`</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">`(\+([0-9A-Za-z\-]+(\.[0-9A-Za-z\-]+)*))?$`</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">TestVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">t </span><span class="token operator">*</span><span class="token plain">testing</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">T</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> ok</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">_</span><span class="token plain"> </span><span class="token operator">:=</span><span class="token plain"> regexp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">MatchString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">verRegex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token operator">!</span><span class="token plain">ok </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        t</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Fatalf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;invalid version: %s&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨åº”ç”¨äº¤ä»˜æ—¶éœ€è¦å°† Golang æœåŠ¡æ‰“åŒ…æˆé•œåƒå¹¶ä»¥ KubeVela Application çš„å½¢å¼å‘å¸ƒåˆ° Kubernetes é›†ç¾¤ä¸­ï¼Œå› æ­¤åœ¨ä»£ç ä»“åº“ä¸­è¿˜åŒ…å« <code>Dockerfile</code> ä»¥åŠ <code>app.yaml</code> æ–‡ä»¶ï¼Œåˆ†åˆ«ç”¨æ¥æè¿°é•œåƒçš„æ‰“åŒ…æ–¹å¼ä»¥åŠ Application çš„ç›¸å…³é…ç½®ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly Dockerfile"><div tabindex="0" class="prism-code language-Dockerfile codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain"># Dockerfile</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">FROM golang:1.13-rc-alpine3.10 as builder</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">WORKDIR /app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">COPY main.go .</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">RUN go build -o kubevela-demo-cicd-app main.go</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">FROM alpine:3.10</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">WORKDIR /app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">COPY --from=builder /app/kubevela-demo-cicd-app /app/kubevela-demo-cicd-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">ENTRYPOINT ./kubevela-demo-cicd-app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">EXPOSE 8088</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åœ¨ app.yaml ä¸­ï¼Œå£°æ˜äº†éƒ¨ç½²çš„åº”ç”¨åŒ…å« 5 ä¸ªä¸åŒå‰¯æœ¬ï¼ŒåŒæ—¶é€šè¿‡ Ingress çš„å½¢å¼å‘å¸ƒç»™é›†ç¾¤å¤–éƒ¨ã€‚è€Œ labels åˆ™æ˜¯ç»™åº”ç”¨ä¸­çš„ Pod æ‰“ä¸Šäº†å½“å‰çš„ git commit ä½œä¸ºæ ‡ç­¾ã€‚å½“ Jenkins çš„éƒ¨ç½²æµæ°´çº¿è¿è¡Œæ—¶ï¼Œä¼šå°† GIT_COMMIT æ³¨å…¥å…¶ä¸­ï¼Œæäº¤åˆ° KubeVela apiserverï¼Œä»è€Œè§¦å‘ Application çš„æ›´æ–°ã€‚åœ¨ç‰ˆæœ¬æ›´æ–°è¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§ 2, 3 çš„æ•°é‡åˆ†ä¸¤æ¬¡æ¬¡æ›´æ–°å‰¯æœ¬ï¼ŒåŒæ—¶åœ¨ç¬¬ä¸€æ¬¡æ›´æ–°ååœæ­¢è‡ªåŠ¨æ›´æ–°ï¼Œç­‰å¾…æ‰‹åŠ¨ç¡®è®¤åå†è¿›è¡Œå…¨éƒ¨æ›´æ–°ï¼Œå®ç°é‡‘ä¸é›€å‘å¸ƒçš„è¿‡ç¨‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># app.yaml</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> core.oam.dev/v1beta1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kubevela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kubevela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">web</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> somefive/kubevela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cicd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">imagePullPolicy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Always</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">traits</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> rollout</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">rolloutBatches</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">batchPartition</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">targetSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> labels</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">jenkins-build-commit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> GIT_COMMIT</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ingress</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">properties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> kubevela</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cicd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">app.cf7c0ed25b151437ebe1ef58efc29bca4.us</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">west</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">1.alicontainer.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token key atrule">&quot;/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8088</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é…ç½®-ci-æµæ°´çº¿"></a>é…ç½® CI æµæ°´çº¿<a class="hash-link" href="#é…ç½®-ci-æµæ°´çº¿" title="Direct link to heading">#</a></h2><p>åœ¨æœ¬æ–‡çš„æ¡ˆä¾‹ä¸­ï¼ŒåŒ…å«ä¸¤æ¡æµæ°´çº¿ï¼Œä¸€æ¡æ˜¯ç”¨æ¥è¿›è¡Œæµ‹è¯•çš„æµæ°´çº¿ (å¯¹åº”ç”¨ä»£ç è¿è¡Œæµ‹è¯•) ï¼Œä¸€æ¡æ˜¯äº¤ä»˜æµæ°´çº¿ (å°†åº”ç”¨ä»£ç æ‰“åŒ…ä¸Šä¼ é•œåƒä»“åº“ï¼ŒåŒæ—¶æ›´æ–°ç›®æ ‡ç¯å¢ƒä¸­çš„åº”ç”¨ï¼Œå®ç°è‡ªåŠ¨æ›´æ–°) ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æµ‹è¯•æµæ°´çº¿"></a>æµ‹è¯•æµæ°´çº¿<a class="hash-link" href="#æµ‹è¯•æµæ°´çº¿" title="Direct link to heading">#</a></h3><p>åœ¨ Jenkins ä¸­åˆ›å»ºä¸€æ¡æ–°çš„ Pipelineï¼Œå¹¶é…ç½® Build Triggers ä¸º GitHub hook trigger for GITScm pollingã€‚</p><p><img alt="test-pipeline-create" src="/zh/assets/images/test-pipeline-create-34edf7a7b95307cec884803ca545c2e3.png">
<img alt="test-pipeline-config" src="/zh/assets/images/test-pipeline-config-3ae2830ca7d45dbe9579a7814d96abc0.png"></p><p>åœ¨è¿™æ¡æµæ°´çº¿ä¸­ï¼Œé¦–å…ˆæ˜¯é‡‡ç”¨äº† golang çš„é•œåƒä½œä¸ºæ‰§è¡Œç¯å¢ƒï¼Œæ–¹ä¾¿åç»­è¿è¡Œæµ‹è¯•ã€‚ç„¶åå°†åˆ†æ”¯é…ç½®ä¸º GitHub ä»“åº“ä¸­çš„ dev åˆ†æ”¯ï¼Œä»£è¡¨è¯¥æ¡æµæ°´çº¿è¢« Push äº‹ä»¶è§¦å‘åä¼šæ‹‰å– dev åˆ†æ”¯ä¸Šçš„å†…å®¹å¹¶æ‰§è¡Œæµ‹è¯•ã€‚æµ‹è¯•ç»“æŸåå°†æµæ°´çº¿çš„çŠ¶æ€å›å†™è‡³ GitHub ä¸­ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly groovy"><div tabindex="0" class="prism-code language-groovy codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">void setBuildStatus(String message, String state) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  step([</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      $class: &quot;GitHubCommitStatusSetter&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      reposSource: [$class: &quot;ManuallyEnteredRepositorySource&quot;, url: &quot;https://github.com/Somefive/KubeVela-demo-CICD-app&quot;],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      contextSource: [$class: &quot;ManuallyEnteredCommitContextSource&quot;, context: &quot;ci/jenkins/test-status&quot;],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      errorHandlers: [[$class: &quot;ChangingBuildStatusErrorHandler&quot;, result: &quot;UNSTABLE&quot;]],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      statusResultSource: [ $class: &quot;ConditionalStatusResultSource&quot;, results: [[$class: &quot;AnyBuildResult&quot;, message: message, state: state]] ]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  ]);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">pipeline {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    agent {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        docker { image &#x27;golang:1.13-rc-alpine3.10&#x27; }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    stages {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Prepare&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                script {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    def checkout = git branch: &#x27;dev&#x27;, url: &#x27;https://github.com/Somefive/KubeVela-demo-CICD-app.git&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env.GIT_COMMIT = checkout.GIT_COMMIT</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env.GIT_BRANCH = checkout.GIT_BRANCH</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    echo &quot;env.GIT_BRANCH=${env.GIT_BRANCH},env.GIT_COMMIT=${env.GIT_COMMIT}&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                setBuildStatus(&quot;Test running&quot;, &quot;PENDING&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Test&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                sh &#x27;CGO_ENABLED=0 GOCACHE=$(pwd)/.cache go test *.go&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    post {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        success {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            setBuildStatus(&quot;Test success&quot;, &quot;SUCCESS&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        failure {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            setBuildStatus(&quot;Test failed&quot;, &quot;FAILURE&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éƒ¨ç½²æµæ°´çº¿"></a>éƒ¨ç½²æµæ°´çº¿<a class="hash-link" href="#éƒ¨ç½²æµæ°´çº¿" title="Direct link to heading">#</a></h3><p>åœ¨éƒ¨ç½²æµæ°´çº¿ä¸­ï¼Œç±»ä¼¼æµ‹è¯•æµæ°´çº¿ï¼Œé¦–å…ˆå°†ä»£ç ä»“åº“ä¸­çš„åˆ†æ”¯æ‹‰å–ä¸‹æ¥ï¼ŒåŒºåˆ«æ˜¯è¿™é‡Œé‡‡ç”¨ prod åˆ†æ”¯ã€‚ç„¶åä½¿ç”¨ Docker è¿›è¡Œé•œåƒæ„å»ºå¹¶æ¨é€è‡³è¿œç«¯é•œåƒä»“åº“ (è¿™é‡Œä¸º DockerHubï¼Œå…¶ä¸­ withRegistry ä¸­å¡«å†™é•œåƒä»“åº“ä½ç½®ä»¥åŠåœ¨å…ˆå‰æ­¥éª¤ä¸­å­˜å…¥çš„ DockerHub çš„è´¦æˆ·å¯¹åº”çš„ Credential çš„ ID) ã€‚æ„å»ºæˆåŠŸåï¼Œå†å°† Application å¯¹åº”çš„ YAML æ–‡ä»¶è½¬æ¢ä¸º JSON æ–‡ä»¶å¹¶æ³¨å…¥ GIT_COMMITï¼Œæœ€åå‘ KubeVela apiserver (æ­¤å¤„ä¸º <a href="http://47.88.24.19/" target="_blank" rel="noopener noreferrer">http://47.88.24.19/</a>) å‘é€è¯·æ±‚è¿›è¡Œåˆ›å»ºæˆ–æ›´æ–°ã€‚</p><blockquote><p>ç›®å‰çš„ KubeVela apiserver æ¥æ”¶ JSON å‚æ•°ï¼Œå› æ­¤åœ¨æµæ°´çº¿ä¸­åšäº†ç›¸åº”çš„è½¬æ¢ã€‚æœªæ¥çš„ KubeVela apiserver å°†ä¼šè¿›ä¸€æ­¥æ”¹è¿›äº¤äº’æ¨¡å¼ï¼Œç®€åŒ–æ­¤å¤„çš„æµç¨‹ï¼ŒåŒæ—¶å†åŠ ä¸Šæ›´ä¸ºä¸¥æ ¼çš„æƒé™è®¤è¯ï¼Œæé«˜å®‰å…¨æ€§ã€‚</p></blockquote><blockquote><p>è¯¥æ¡ˆä¾‹ä¸­ä¼šå‘ kubevela-demo-namespace è¿™ä¸ª Namespace ä¸­åˆ›å»ºåå« cicd-demo-app çš„åº”ç”¨ï¼Œæ³¨æ„è¿™ä¸ª Namespace éœ€è¦é¢„å…ˆåœ¨ Kubernetes ä¸­åˆ›å»ºå‡ºæ¥ã€‚æœªæ¥ KubeVela çš„ apiserver åŒæ ·ä¼šç®€åŒ–è¿™ä¸€æµç¨‹ã€‚</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly groovy"><div tabindex="0" class="prism-code language-groovy codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">void setBuildStatus(String message, String state) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  step([</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      $class: &quot;GitHubCommitStatusSetter&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      reposSource: [$class: &quot;ManuallyEnteredRepositorySource&quot;, url: &quot;https://github.com/Somefive/KubeVela-demo-CICD-app&quot;],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      contextSource: [$class: &quot;ManuallyEnteredCommitContextSource&quot;, context: &quot;ci/jenkins/deploy-status&quot;],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      errorHandlers: [[$class: &quot;ChangingBuildStatusErrorHandler&quot;, result: &quot;UNSTABLE&quot;]],</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      statusResultSource: [ $class: &quot;ConditionalStatusResultSource&quot;, results: [[$class: &quot;AnyBuildResult&quot;, message: message, state: state]] ]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  ]);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">pipeline {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    agent any</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    stages {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Prepare&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                script {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    def checkout = git branch: &#x27;prod&#x27;, url: &#x27;https://github.com/Somefive/KubeVela-demo-CICD-app.git&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env.GIT_COMMIT = checkout.GIT_COMMIT</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    env.GIT_BRANCH = checkout.GIT_BRANCH</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    echo &quot;env.GIT_BRANCH=${env.GIT_BRANCH},env.GIT_COMMIT=${env.GIT_COMMIT}&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    setBuildStatus(&quot;Deploy running&quot;, &quot;PENDING&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Build&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                script {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    docker.withRegistry(&quot;https://registry.hub.docker.com&quot;, &quot;DockerHubCredential&quot;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                        def customImage = docker.build(&quot;somefive/kubevela-demo-cicd-app&quot;)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                        customImage.push()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        stage(&#x27;Deploy&#x27;) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            steps {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                sh &#x27;wget -q &quot;https://github.com/mikefarah/yq/releases/download/v4.12.1/yq_linux_amd64&quot;&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                sh &#x27;chmod +x yq_linux_amd64&#x27;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                script {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    def app = sh (</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                        script: &quot;./yq_linux_amd64 eval -o=json &#x27;.spec&#x27; app.yaml | sed -e &#x27;s/GIT_COMMIT/$GIT_COMMIT/g&#x27;&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                        returnStdout: true</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    )</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    echo &quot;app: ${app}&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    def response = httpRequest acceptType: &#x27;APPLICATION_JSON&#x27;, contentType: &#x27;APPLICATION_JSON&#x27;, httpMode: &#x27;POST&#x27;, requestBody: app, url: &quot;http://47.88.24.19/v1/namespaces/kubevela-demo-namespace/applications/cicd-demo-app&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    println(&#x27;Status: &#x27;+response.status)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                    println(&#x27;Response: &#x27;+response.content)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    post {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        success {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            setBuildStatus(&quot;Deploy success&quot;, &quot;SUCCESS&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        failure {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            setBuildStatus(&quot;Deploy failed&quot;, &quot;FAILURE&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®é™…è¡¨ç°"></a>å®é™…è¡¨ç°<a class="hash-link" href="#å®é™…è¡¨ç°" title="Direct link to heading">#</a></h2><p>åœ¨å®Œæˆä¸Šè¿°çš„é…ç½®æµç¨‹åï¼ŒæŒç»­äº¤ä»˜çš„æµç¨‹ä¾¿å·²ç»æ­å»ºå®Œæˆã€‚æˆ‘ä»¬å¯ä»¥æ¥æ£€éªŒä¸€ä¸‹å®ƒçš„æ•ˆæœã€‚</p><p><img alt="pipeline-overview" src="/zh/assets/images/pipeline-overview-36827d3925d667b9d14612cb59e8fb4e.png"></p><p>æˆ‘ä»¬é¦–å…ˆå°† <code>main.go</code> ä¸­çš„ <code>VERSION</code> å­—æ®µä¿®æ”¹ä¸º <code>Bad Version Number</code>ï¼Œå³</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><div tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> VERSION </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Bad Version Number&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ç„¶åæäº¤è¯¥ä¿®æ”¹è‡³ dev åˆ†æ”¯ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Jenkins ä¸Šçš„æµ‹è¯•æµæ°´çº¿è¢«è§¦å‘è¿è¡Œï¼Œå¤±è´¥åå°†è¯¥çŠ¶æ€å›å†™ç»™ GitHubã€‚</p><p><img alt="test-pipeline-fail" src="/zh/assets/images/test-pipeline-fail-23682b9d0c60a43f26be0a5a98e8a413.png">
<img alt="test-github-fail" src="/zh/assets/images/test-github-fail-5dd21696c58a212cf6ca2ee80e56567e.png"></p><p>æˆ‘ä»¬é‡æ–°å°† <code>VERSION</code> ä¿®æ”¹ä¸º 0.1.1ï¼Œç„¶åå†æ¬¡æäº¤ã€‚å¯ä»¥çœ‹åˆ°è¿™ä¸€æ¬¡æµ‹è¯•æµæ°´çº¿æˆåŠŸå®Œæˆæ‰§è¡Œï¼Œå¹¶åœ¨ GitHub å¯¹åº”çš„ Commit ä¸Šçœ‹åˆ°äº†æˆåŠŸçš„æ ‡å¿—ã€‚</p><p><img alt="test-pipeline-success" src="/zh/assets/images/test-pipeline-success-cd84def7976efb35b5071c9e361d2a77.png">
<img alt="test-github-success" src="/zh/assets/images/test-github-success-1d9c59d67bfd9b24d8b455fa21c6d985.png"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ GitHub ä¸Šæäº¤ Pull Request å°è¯•å°† dev åˆ†æ”¯ä¸Šçš„æ›´æ–°åˆå¹¶è‡³ prod åˆ†æ”¯ä¸Šã€‚</p><p><img alt="pull-request" src="/zh/assets/images/pull-request-eca7ff259bb26a6661d79691728b0b31.png"></p><p>å¯ä»¥çœ‹åˆ°åœ¨ Jenkins çš„éƒ¨ç½²æµæ°´çº¿æˆåŠŸè¿è¡Œç»“æŸåï¼ŒGitHub ä¸Š prod åˆ†æ”¯æœ€æ–°çš„ Commit ä¹Ÿæ˜¾ç¤ºäº†æˆåŠŸçš„æ ‡å¿—ã€‚</p><p><img alt="deploy-pipeline-success" src="/zh/assets/images/deploy-pipeline-success-7890c92b41e666ef46f3bd2dc1975ee7.png">
<img alt="deploy-github-success" src="/zh/assets/images/deploy-github-success-07f305b1b587e3fa8acc5df68fd8c297.png"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get app -n kubevela-demo-namespace</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                     COMPONENT               TYPE         PHASE     HEALTHY   STATUS   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-cicd-app   kubevela-demo-app-web   webservice   running   </span><span class="token boolean">true</span><span class="token plain">               112s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get deployment -n kubevela-demo-namespace</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                       READY   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">2</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           2m1s</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¦‚å›¾æ˜¾ç¤ºï¼Œè¦éƒ¨ç½²çš„åº”ç”¨é¡ºåˆ©è¢« KubeVela apiserver æ¥å—å¹¶ç”± KubeVela æ§åˆ¶å™¨åˆ›å»ºäº†ç›¸å…³èµ„æºã€‚å½“å‰ Deployment çš„å‰¯æœ¬æ•°æ˜¯ 2ï¼Œåœ¨åˆ é™¤äº†è¯¥ Application ä¸­ rollout ç‰¹å¾å†…çš„ <code>batchPartition: 0</code> åä»£è¡¨ç¡®è®¤äº†å½“å‰çš„å‘å¸ƒï¼Œç„¶åå¯¹åº”çš„ Deployment å‰¯æœ¬æ•°æ›´æ–°è‡³ 5ã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥è®¿é—® Ingress æ‰€é…ç½®çš„åŸŸåï¼ŒæˆåŠŸæ˜¾ç¤ºäº†å½“å‰çš„ç‰ˆæœ¬å·ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl edit app -n kubevela-demo-namespace</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">application.core.oam.dev/kubevela-demo-cicd-app edited</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get deployment -n kubevela-demo-namespace -w</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                       READY   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">4</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">4</span><span class="token plain">           3m39s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           3m39s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           3m40s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           3m40s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œå°†ç‰ˆæœ¬å‡çº§è‡³ 0.1.2ï¼Œå®Œæˆæµ‹è¯•æµæ°´çº¿åŠéƒ¨ç½²æµæ°´çº¿ã€‚æ¥ç€æˆ‘ä»¬ä¼šå‘ç° Kubernetes çš„é›†ç¾¤å†…å¯¹åº”çš„ Application æ§åˆ¶çš„ Deployment å‘ç”Ÿäº†ç‰ˆæœ¬æ›´æ›¿ï¼Œæ—§ç‰ˆæœ¬çš„ Deployment ä» 5 å‰¯æœ¬ä¸‹é™åˆ° 3 å‰¯æœ¬ï¼Œæ–°ç‰ˆæœ¬çš„ Deployment åˆ™å‡ºç°äº† 2 å‰¯æœ¬ã€‚å¦‚æœæ­¤æ—¶æˆ‘ä»¬å†è®¿é—®åŸæ¥çš„æœåŠ¡åœ°å€ï¼Œä¼šå‘ç°æœ‰æ—¶ä¼šæ˜¾ç¤º 0.1.1 ç‰ˆæœ¬ï¼Œæœ‰æ—¶ä¼šæ˜¾ç¤º 0.1.2 ç‰ˆæœ¬ã€‚è¿™æ˜¯å› ä¸ºåœ¨å½“å‰æ»šåŠ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œæ–°æ—§å‰¯æœ¬åŒæ—¶å­˜åœ¨ï¼Œè®¿é—®çš„æµé‡ä¼šè¢«è´Ÿè½½å‡è¡¡å™¨åˆ†å‘åˆ°ä¸åŒçš„å‰¯æœ¬ä¸Šï¼Œå› æ­¤ä¼šå‡ºç°ä¸¤ç§ç‰ˆæœ¬çš„æœåŠ¡åŒæ—¶å­˜åœ¨çš„ç°è±¡ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get deployment -n kubevela-demo-namespace -w</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                       READY   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           11m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           12m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/2     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/2     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/2     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">0</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           0s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           12m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">1</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">1</span><span class="token plain">           2s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           2s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/3     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           13m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">5</span><span class="token plain">/3     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           13m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">3</span><span class="token plain">/3     </span><span class="token number">3</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           13m</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://kubevela-demo-cicd-app.cf7c0ed25b151437ebe1ef58efc29bca4.us-west-1.alicontainer.com/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Version: </span><span class="token number">0.1</span><span class="token plain">.1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å½“æˆ‘ä»¬ç¡®è®¤æ–°ç‰ˆæœ¬çš„æœåŠ¡æ­£å¸¸è¿ä½œåï¼Œå¯ä»¥ç±»ä¼¼ä¸Šè¿°æ­¥éª¤ï¼Œå°† Application ä¸­ rollout ç‰¹æ€§å†…çš„ <code>batchPartition: 0</code> åˆ å»ï¼Œå®Œæˆæ•´ä¸ªé‡‘ä¸é›€å‘å¸ƒæµç¨‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ kubectl get deployment -n kubevela-demo-namespace -w</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NAME                       READY   UP-TO-DATE   AVAILABLE   AGE</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">3</span><span class="token plain">/3     </span><span class="token number">3</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/2     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m24s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/5     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m36s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/5     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m37s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/5     </span><span class="token number">2</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m37s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">2</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">2</span><span class="token plain">           5m37s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">3</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           5m38s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">4</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">4</span><span class="token plain">           5m38s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           5m39s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">3</span><span class="token plain">/0     </span><span class="token number">3</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">3</span><span class="token plain">/0     </span><span class="token number">3</span><span class="token plain">            </span><span class="token number">3</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           18m</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           5m41s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v2   </span><span class="token number">5</span><span class="token plain">/5     </span><span class="token number">5</span><span class="token plain">            </span><span class="token number">5</span><span class="token plain">           5m41s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">kubevela-demo-app-web-v1   </span><span class="token number">0</span><span class="token plain">/0     </span><span class="token number">0</span><span class="token plain">            </span><span class="token number">0</span><span class="token plain">           18m</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å°ç»“"></a>å°ç»“<a class="hash-link" href="#å°ç»“" title="Direct link to heading">#</a></h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä¾¿å·²ç»æˆåŠŸå®ç°äº†ä¸€æ•´å¥—æŒç»­äº¤ä»˜æµç¨‹ã€‚åœ¨è¿™ä¸ªæµç¨‹ä¸­ï¼Œåº”ç”¨çš„å¼€å‘è€…å€ŸåŠ© KubeVela + Jenkins çš„èƒ½åŠ›ï¼Œå¯ä»¥è½»æ¾å®Œæˆåº”ç”¨çš„è¿­ä»£æ›´æ–°ã€é›†æˆæµ‹è¯•ã€è‡ªåŠ¨å‘å¸ƒä¸æ»šåŠ¨å‡çº§ï¼Œè€Œæ•´ä¸ªæµç¨‹åœ¨å„ä¸ªç¯èŠ‚ä¹Ÿå¯ä»¥æŒ‰ç…§å¼€å‘è€…çš„å–œå¥½å’Œæ¡ä»¶é€‰æ‹©ä¸åŒçš„å·¥å…·ï¼Œæ¯”å¦‚ä½¿ç”¨ Gitlab æ›¿ä»£ GitHubï¼Œæˆ–æ˜¯ä½¿ç”¨ TravisCI æ›¿ä»£ Jenkinsã€‚</p><p>åœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼Œç»†å¿ƒçš„è¯»è€…å¯èƒ½è¿˜ä¼šå‘ç°ï¼Œè¿™å¥—æµç¨‹ä¸ä»…èƒ½å¤Ÿå®ç°åº”ç”¨æœåŠ¡çš„å‡çº§ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡ä¿®æ”¹ app.yaml è‡ªåŠ¨å®Œæˆéƒ¨ç½²æ–¹æ¡ˆçš„å‡çº§ï¼Œæ¯”å¦‚å°† 5 å‰¯æœ¬åº”ç”¨æ‰©å®¹åˆ° 10 å‰¯æœ¬ï¼Œæˆ–æ˜¯ä¸ºå®¹å™¨æ·»åŠ  sidecarï¼Œä»è€Œå®ç°éƒ¨åˆ† GitOps èƒ½åŠ›ã€‚å…³äºä½¿ç”¨ KubeVela å®è·µ GitOps çš„æ›´å¤šå†…å®¹ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥ç»§ç»­é˜…è¯»ç›¸å…³æ¡ˆä¾‹ã€‚</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kubevela">kubevela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/kubevela-official-documentation-translation-event">KubeVela å®˜æ–¹æ–‡æ¡£ç¿»è¯‘æ´»åŠ¨</a></h2><div class="margin-vert--md"><time datetime="2021-09-05T14:52:55.836Z" class="blogPostDate_fNvV">2021å¹´9æœˆ5æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="èƒŒæ™¯"></a>èƒŒæ™¯<a class="hash-link" href="#èƒŒæ™¯" title="Direct link to heading">#</a></h2><p>KubeVela v1.0 å¯ç”¨äº†æ–°çš„å®˜ç½‘æ¶æ„å’Œæ–‡æ¡£ç»´æŠ¤æ–¹å¼ï¼Œæ–°å¢åŠŸèƒ½åŒ…æ‹¬æ–‡æ¡£ç‰ˆæœ¬åŒ–æ§åˆ¶ã€i18n å›½é™…åŒ–ä»¥åŠè‡ªåŠ¨åŒ–æµç¨‹ã€‚ä½†ç›®å‰ KubeVela å®˜æ–¹æ–‡æ¡£åªæœ‰è‹±æ–‡ç‰ˆï¼Œè¿™æé«˜äº†å­¦ä¹ å’Œä½¿ç”¨ KubeVela çš„é—¨æ§›ï¼Œä¸åˆ©äºé¡¹ç›®çš„ä¼ æ’­å’Œå‘å±•ï¼ŒåŒæ—¶ç¿»è¯‘å·¥ä½œä¹Ÿèƒ½æ˜¾è‘—æå‡è¯­è¨€èƒ½åŠ›ï¼Œå¸®åŠ©æˆ‘ä»¬æ‹“å®½é˜…è¯»æŠ€æœ¯èµ„æ–™çš„å¹¿åº¦ï¼Œæ•…ç»„ç»‡æœ¬æ¬¡æ´»åŠ¨ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ´»åŠ¨æµç¨‹"></a>æ´»åŠ¨æµç¨‹<a class="hash-link" href="#æ´»åŠ¨æµç¨‹" title="Direct link to heading">#</a></h2><p>æœ¬æ¬¡æ´»åŠ¨ä¸»è¦åœ¨ <a href="https://github.com/oam-dev/kubevela.io" target="_blank" rel="noopener noreferrer">kubevela.io</a> repo ä¸‹è¿›è¡Œï¼ŒæŠ¥åå‚ä¸å’Œè®¤é¢†ä»»åŠ¡éƒ½åœ¨ <a href="https://shimo.im/sheets/QrCwcDqh8xkRWKPC/MODOC" target="_blank" rel="noopener noreferrer">KubeVela å®˜æ–¹æ–‡æ¡£ç¿»è¯‘ç™»è®°</a> ä¸­ï¼ˆ<strong>è¯·åŠ¡å¿…åœ¨è¡¨æ ¼ä¸­ç™»è®°ä¿¡æ¯</strong>ï¼‰ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¼€å§‹ç¿»è¯‘"></a>å¼€å§‹ç¿»è¯‘<a class="hash-link" href="#å¼€å§‹ç¿»è¯‘" title="Direct link to heading">#</a></h3><p><img src="https://tvax1.sinaimg.cn/large/ad5fbf65gy1gpdbriuraij20k20l6dhm.jpg" alt="ç¿»è¯‘æµç¨‹"></p><p>å‚ä¸ç¿»è¯‘æ´»åŠ¨çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ä»»åŠ¡é¢†å–ï¼šåœ¨ <a href="https://shimo.im/sheets/QrCwcDqh8xkRWKPC/MODOC" target="_blank" rel="noopener noreferrer">KubeVela å®˜æ–¹æ–‡æ¡£ç¿»è¯‘ç™»è®°</a> ç™»è®°å¹¶è®¤é¢†ä»»åŠ¡ï¼›</li><li>æäº¤ï¼šå‚ä¸äººå‘˜æäº¤ PR ç­‰å¾… reviewï¼›</li><li>å®¡é˜…ï¼šmaintainer å®¡é˜… PRï¼›</li><li>ç»ˆå®¡ï¼š å¯¹ review åçš„å†…å®¹è¿›è¡Œæœ€åç¡®è®¤ï¼›</li><li>åˆå¹¶ï¼šmerge åˆ° master åˆ†æ”¯ï¼Œä»»åŠ¡ç»“æŸã€‚</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‚ä¸æŒ‡å—"></a>å‚ä¸æŒ‡å—<a class="hash-link" href="#å‚ä¸æŒ‡å—" title="Direct link to heading">#</a></h3><p>ä¸‹é¢å…·ä½“ä»‹ç»å‚ä¸ç¿»è¯‘çš„å…·ä½“å·¥ä½œã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ<a class="hash-link" href="#å‡†å¤‡å·¥ä½œ" title="Direct link to heading">#</a></h4><ul><li>è´¦å·ï¼šä½ éœ€è¦å…ˆå‡†å¤‡ä¸€ä¸ª GitHub è´¦å·ã€‚ä½¿ç”¨ Github è¿›è¡Œç¿»è¯‘ä»»åŠ¡çš„è®¤é¢†å’Œ PR æäº¤ã€‚</li><li>ä»“åº“å’Œåˆ†æ”¯ç®¡ç†<ul><li>fork <a href="https://github.com/oam-dev/kubevela.io" target="_blank" rel="noopener noreferrer">kubevela.io</a> çš„ä»“åº“ï¼Œå¹¶ä½œä¸ºè‡ªå·±ä»“åº“çš„ä¸Šæ¸¸ï¼š <code>git remote add upstream https://github.com/oam-dev/kubevela.io.git</code></li><li>åœ¨è‡ªå·±çš„ä»“åº“ï¼Œä¹Ÿå°±æ˜¯ origin ä¸Šè¿›è¡Œç¿»è¯‘ï¼›</li><li>ä¸€ä¸ªä»»åŠ¡æ–°å»ºä¸€ä¸ª branch</li></ul></li><li>Node.js ç‰ˆæœ¬ &gt;= 12.13.0 ï¼ˆå¯ä»¥ä½¿ç”¨ <code>node -v</code> å‘½ä»¤æŸ¥çœ‹ï¼‰</li><li>Yarn ç‰ˆæœ¬ &gt;= 1.5ï¼ˆå¯ä»¥ä½¿ç”¨ <code>yarn --version</code> å‘½ä»¤æŸ¥çœ‹ï¼‰</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‚ä¸æ­¥éª¤"></a>å‚ä¸æ­¥éª¤<a class="hash-link" href="#å‚ä¸æ­¥éª¤" title="Direct link to heading">#</a></h4><p><strong>Step1ï¼šä»»åŠ¡æµè§ˆ</strong></p><p>åœ¨ <a href="https://shimo.im/sheets/QrCwcDqh8xkRWKPC/MODOC" target="_blank" rel="noopener noreferrer">KubeVela å®˜æ–¹æ–‡æ¡£ç¿»è¯‘ç™»è®°</a> ç™»è®°å¹¶æµè§ˆæœ‰å“ªäº›ä»»åŠ¡å¯ä»¥è®¤é¢†ã€‚</p><p><strong>Step2ï¼šä»»åŠ¡é¢†å–</strong></p><p>åœ¨ <a href="https://shimo.im/sheets/QrCwcDqh8xkRWKPC/MODOC" target="_blank" rel="noopener noreferrer">KubeVela å®˜æ–¹æ–‡æ¡£ç¿»è¯‘ç™»è®°</a> è¡¨æ ¼ä¸­ç¼–è¾‘å¹¶è®¤é¢†ä»»åŠ¡ã€‚æ³¨æ„ï¼šä¸ºä¿è¯è´¨é‡ï¼ŒåŒä¸€è¯‘è€…åªèƒ½åŒæ—¶è®¤é¢†ä¸‰ä¸ªä»»åŠ¡ï¼Œå®Œæˆåæ‰å¯ç»§ç»­è®¤é¢†ã€‚</p><p><strong>Step3ï¼šæœ¬åœ°æ„å»ºå’Œé¢„è§ˆ</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># å‘½ä»¤å®‰è£…ä¾èµ–</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># æœ¬åœ°è¿è¡Œä¸­æ–‡æ–‡æ¡£</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> run start -- --locale zh</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> run v1.22.10</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">warning From Yarn </span><span class="token number">1.0</span><span class="token plain"> onwards, scripts don&#x27;t require </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;--&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> options to be forwarded. In a future version, any explicit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;--&quot;</span><span class="token plain"> will be forwarded as-is to the scripts.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$ docusaurus start --locale zh</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Starting the development server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Docusaurus website is running at: http://localhost:3000/zh/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ” Client</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Compiled successfully </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token number">7</span><span class="token plain">.54s</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â„¹ ï½¢wdsï½£: Project is running at http://localhost:3000/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â„¹ ï½¢wdsï½£: webpack output is served from /zh/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â„¹ ï½¢wdsï½£: Content not from webpack is served from /Users/saybot/own/kubevela.io</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">â„¹ ï½¢wdsï½£: 404s will fallback to /index.html</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">âœ” Client</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  Compiled successfully </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token number">137</span><span class="token plain">.94ms</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¯·å‹¿ä¿®æ”¹ <code>/docs</code> ç›®å½•ä¸‹å†…å®¹ï¼Œä¸­æ–‡æ–‡æ¡£åœ¨ <code>/i18n/zh/docusaurus-plugin-content-docs</code> ä¸­ï¼Œä¹‹åå°±å¯ä»¥åœ¨ http://localhost:3000/zh/ ä¸­è¿›è¡Œé¢„è§ˆäº†ã€‚</p><p><strong>Step4ï¼šæäº¤ PR</strong></p><p>ç¡®è®¤ç¿»è¯‘å®Œæˆå°±å¯ä»¥æäº¤ PR äº†ï¼Œæ³¨æ„ï¼šä¸ºäº†æ–¹ä¾¿ review æ¯ç¯‡ç¿»è¯‘ä¸º<strong>ä¸€ä¸ª PR</strong>ï¼Œå¦‚æœç¿»è¯‘å¤šç¯‡è¯· checkout <strong>å¤šä¸ªåˆ†æ”¯</strong>å¹¶æäº¤å¤šä¸ª PRã€‚</p><p><strong>Step5ï¼šå®¡é˜…</strong></p><p>ç”± maintainer å¯¹ PR è¿›è¡Œ reviewã€‚</p><p><strong>Step6ï¼šä»»åŠ¡å®Œæˆ</strong></p><p>ç¿»è¯‘åˆæ ¼çš„æ–‡ç« å°†ä¼š merge åˆ° <a href="https://github.com/oam-dev/kubevela.io" target="_blank" rel="noopener noreferrer">kubevela.io</a> çš„ master åˆ†æ”¯è¿›è¡Œå‘å¸ƒã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç¿»è¯‘è¦æ±‚"></a>ç¿»è¯‘è¦æ±‚<a class="hash-link" href="#ç¿»è¯‘è¦æ±‚" title="Direct link to heading">#</a></h3><ul><li>æ•°å­—å’Œè‹±æ–‡ä¸¤è¾¹æ˜¯ä¸­æ–‡è¦åŠ ç©ºæ ¼ã€‚</li><li>KubeVela ç»Ÿä¸€å†™æ³•ã€‚K å’Œ V å¤§å†™ã€‚</li><li>ç¿»è¯‘å®Œè¯·å…ˆé˜…è¯»ä¸€éï¼Œä¸è¦å‡ºç°é—æ¼æ®µè½ï¼Œä¿è¯æ–‡ç« é€šé¡ºã€ç¬¦åˆä¸­æ–‡é˜…è¯»ä¹ æƒ¯ã€‚ä¸è¿½æ±‚ä¸¥æ ¼ä¸€è‡´ï¼Œå¯ä»¥æ„è¯‘ã€‚review çš„æ—¶å€™ä¹Ÿä¼šæ£€éªŒã€‚</li><li>ä½ å’Œæ‚¨ä¸è¦æ··ç”¨ï¼Œç»Ÿä¸€ä½¿ç”¨ç”¨ <strong>â€œä½ â€</strong>ã€‚</li><li>ä¸ä¼šç¿»è¯‘çš„è¯æ±‡å¯ä»¥ä¸ç¿»è¯‘ï¼Œå¯ä»¥åœ¨ PR ä¸­è¯´æ˜ï¼Œreview çš„æ—¶å€™ä¼šæŸ¥çœ‹ã€‚</li><li>Componentã€Workloadã€Trait è¿™äº› OAM/KubeVela é‡Œé¢å®šä¹‰çš„ä¸“å±æ¦‚å¿µä¸è¦ç¿»è¯‘ï¼Œæˆ‘ä»¬ä¹Ÿè¦åŠ å¼ºè¿™äº›è¯æ±‡çš„è®¤çŸ¥ã€‚å¯ä»¥åœ¨ä¸€ç¯‡æ–°æ–‡ç« æœ€å¼€å§‹å‡ºç°çš„æ—¶å€™ç”¨æ‹¬å·åŠ ä¸Šä¸­æ–‡ç¿»è¯‘ã€‚</li><li>æ³¨æ„ä¸­è‹±æ–‡æ ‡ç‚¹ç¬¦å·ã€‚</li><li><code>PR</code> å‘½åè§„èŒƒ <code>Translate &lt;ç¿»è¯‘æ–‡ä»¶ç›¸å¯¹è·¯å¾„&gt;</code>ï¼Œå¦‚ <code>Translate i18n/zh/docusaurus-plugin-content-docs/current/introduction.md</code>ã€‚</li></ul></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/documentation">documentation</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/kubevela-the-extensible-app-platform-based-on-open-application-model-and-kubernetes">KubeVela æ­£å¼å¼€æºï¼šä¸€ä¸ªé«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨å¹³å°ä¸æ ¸å¿ƒå¼•æ“</a></h2><div class="margin-vert--md"><time datetime="2021-09-05T14:52:55.836Z" class="blogPostDate_fNvV">2021å¹´9æœˆ5æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/resouer" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/1701782?s=200&amp;v=4" alt="Lei Zhang and Fei Guo"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/resouer" target="_blank" rel="noopener noreferrer">Lei Zhang and Fei Guo</a></h4><small class="avatar__subtitle">CNCF TOC Member/Kubernetes</small></div></div></header><div class="markdown"><blockquote><p>2020å¹´12æœˆ7æ—¥ 12:33, by Lei Zhang and Fei Guo</p></blockquote><p><img src="https://tva1.sinaimg.cn/large/ad5fbf65gy1glgj5q8inej208g049aa6.jpg" alt="image"></p><p>ç¾å›½è¥¿éƒ¨æ—¶é—´ 2020 å¹´ 11 æœˆ 18 æ—¥ï¼Œåœ¨äº‘åŸç”ŸæŠ€æœ¯â€œæœ€é«˜ç››å®´â€çš„ KubeCon åŒ—ç¾å³°ä¼š 2020 ä¸Šï¼ŒCNCF åº”ç”¨äº¤ä»˜é¢†åŸŸå°ç»„ï¼ˆCNCF SIG App Delivery) ä¸ Open Application Model (OAM) ç¤¾åŒºï¼Œä»¥åŠæ¥è‡ªé˜¿é‡Œäº‘ã€å¾®è½¯äº‘çš„ OAM é¡¹ç›®ç»´æŠ¤è€…ä»¬åœ¨æ¼”è®²ä¸­å…±åŒå®£å¸ƒäº† KubeVela å¼€æºé¡¹ç›®çš„æ­£å¼å‘å¸ƒã€‚</p><p>ä» 11 æœˆ 18 å·åˆ° 20 å·ï¼Œåœ¨ä¸ºæœŸä¸‰å¤©çš„ KubeCon åŒ—ç¾å³°ä¼šä¸Šæœ‰è¿ç»­ 3 åœºæŠ€æœ¯æ¼”è®²ï¼Œä¼šä»ä¸åŒç»´åº¦ä»‹ç»å…³äº KubeVela é¡¹ç›®çš„å…·ä½“ç»†èŠ‚ï¼Œå…¶ä¸­è¿˜åŒ…æ‹¬ä¸€ä¸ªé•¿è¾¾ 1 ä¸ªåŠå°æ—¶çš„ KubeVela äº’åŠ¨æ•™å­¦ç¯èŠ‚ã€‚å¤šä¸ªé‡é‡çº§ç»„ç»‡ä»¥å¦‚æ­¤è§„æ¨¡å’Œå¯†åº¦åœ¨ KubeCon åŒ—ç¾å³°ä¼šæ¼”è®²ä¸­ä»‹ç»ä¸€ä¸ªé¦–æ¬¡å‘å¸ƒçš„ç¤¾åŒºå¼€æºé¡¹ç›®ï¼Œåœ¨ KubeCon è¯ç”Ÿä»¥æ¥å¹¶ä¸å¤šè§ã€‚</p><p>KubeVela Github åœ°å€ï¼š<a href="https://github.com/oam-dev/kubevela/" target="_blank" rel="noopener noreferrer">https://github.com/oam-dev/kubevela/</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»€ä¹ˆæ˜¯-kubevela-ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ KubeVela ï¼Ÿ<a class="hash-link" href="#ä»€ä¹ˆæ˜¯-kubevela-ï¼Ÿ" title="Direct link to heading">#</a></h2><p>ä¸€è¨€ä»¥è”½ä¹‹ï¼Œ<strong>KubeVela æ˜¯ä¸€ä¸ªç®€å•æ˜“ç”¨ä¸”é«˜åº¦å¯æ‰©å±•çš„åº”ç”¨ç®¡ç†å¹³å°ä¸æ ¸å¿ƒå¼•æ“</strong>ã€‚KubeVela æ˜¯åŸºäº Kubernetes ä¸ OAM æŠ€æœ¯æ„å»ºçš„ã€‚</p><p>è¯¦ç»†çš„è¯´ï¼Œå¯¹äºåº”ç”¨å¼€å‘äººå‘˜æ¥è®²ï¼ŒKubeVela æ˜¯ä¸€ä¸ªéå¸¸ä½å¿ƒæ™ºè´Ÿæ‹…çš„äº‘åŸç”Ÿåº”ç”¨ç®¡ç†å¹³å°ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯è®©å¼€å‘äººå‘˜æ–¹ä¾¿å¿«æ·åœ°åœ¨ Kubernetes ä¸Šå®šä¹‰ä¸äº¤ä»˜ç°ä»£å¾®æœåŠ¡åº”ç”¨ï¼Œæ— éœ€äº†è§£ä»»ä½• Kubernetes æœ¬èº«ç›¸å…³çš„ç»†èŠ‚ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼ŒKubeVela å¯ä»¥è¢«è®¤ä¸ºæ˜¯<strong>äº‘åŸç”Ÿç¤¾åŒºçš„ Heroku</strong>ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå¹³å°å›¢é˜Ÿæ¥è®²ï¼ŒKubeVela æ˜¯ä¸€ä¸ªå¼ºå¤§å¹¶ä¸”é«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨å¹³å°æ ¸å¿ƒå¼•æ“ã€‚åŸºäºè¿™æ ·ä¸€ä¸ªå¼•æ“ï¼Œå¹³å°å›¢é˜Ÿå¯ä»¥å¿«é€Ÿã€é«˜æ•ˆåœ°ä»¥ Kubernetes åŸç”Ÿçš„æ–¹å¼åœ¨ KubeVela ä¸­æ¤å…¥ä»»ä½•æ¥è‡ªäº‘åŸç”Ÿç¤¾åŒºçš„åº”ç”¨ç®¡ç†èƒ½åŠ›ï¼Œä»è€ŒåŸºäº KubeVela æ‰“é€ å‡ºè‡ªå·±éœ€è¦çš„äº‘åŸç”Ÿå¹³å°ï¼Œæ¯”å¦‚ï¼šäº‘åŸç”Ÿæ•°æ®åº“ PaaSã€äº‘åŸç”Ÿ AI å¹³å°ã€ç”šè‡³ Serverless æœåŠ¡ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼ŒKubeVela å¯ä»¥è¢«è®¤ä¸ºæ˜¯<strong>ä¸€ä¸ªâ€œä»¥åº”ç”¨ä¸ºä¸­å¿ƒâ€çš„ Kubernetes å‘è¡Œç‰ˆ</strong>ï¼Œä»¥ OAM ä¸ºæ ¸å¿ƒï¼Œè®©å¹³å°å›¢é˜Ÿå¯ä»¥åŸºäº KubeVela å¿«é€Ÿæ‰“é€ å‡ºå±äºè‡ªå·±çš„ PaaSã€Serverless ä¹ƒè‡³ä»»ä½•é¢å‘ç”¨æˆ·çš„äº‘åŸç”Ÿå¹³å°é¡¹ç›®ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>KubeVela è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ<a class="hash-link" href="#kubevela-è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ" title="Direct link to heading">#</a></h2><p>ç°å¦‚ä»Šï¼Œäº‘åŸç”ŸæŠ€æœ¯çš„è¿…çŒ›å‘å±•å¯èƒ½è®©å¾ˆå¤šäººéƒ½æ„Ÿè§‰åˆ°çœ¼èŠ±ç¼­ä¹±ï¼Œä½†å®é™…ä¸Šï¼Œè¿™ä¸ªç”Ÿæ€çš„æ€»ä½“å‘å±•è¶‹åŠ¿å’Œä¸»æ—‹å¾‹ï¼Œæ˜¯é€šè¿‡ Kubernetes æ­å»ºäº†ä¸€ä¸ªç»Ÿä¸€çš„åŸºç¡€è®¾æ–½æŠ½è±¡å±‚ï¼Œä¸ºå¹³å°å›¢é˜Ÿå±è”½æ‰äº†â€œè®¡ç®—â€ã€â€œç½‘ç»œâ€ã€â€œå­˜å‚¨â€ç­‰è¿‡å»æˆ‘ä»¬ä¸å¾—ä¸å…³æ³¨çš„åŸºç¡€è®¾æ–½æ¦‚å¿µï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤ŸåŸºäº Kubernetes æ–¹ä¾¿åœ°æ„å»ºå‡ºä»»ä½•æˆ‘ä»¬æƒ³è¦çš„å‚ç›´ä¸šåŠ¡ç³»ç»Ÿè€Œæ— éœ€å…³å¿ƒä»»ä½•åŸºç¡€è®¾æ–½å±‚çš„ç»†èŠ‚ã€‚è¿™æ­£æ˜¯ Kubernetes è¢«ç§°ä¸ºäº‘è®¡ç®—ç•Œçš„ Linux ä»¥åŠ â€œPlatform for Platformsâ€ çš„æ ¹æœ¬åŸå› ã€‚</p><p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬æŠŠè§†è§’ä»å¹³å°å›¢é˜Ÿæå‡åˆ°å‚ç›´ä¸šåŠ¡ç³»ç»Ÿçš„æœ€ç»ˆç”¨æˆ·ï¼ˆå¦‚ï¼šåº”ç”¨å¼€å‘äººå‘˜ï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç° Kubernetes è¿™æ ·çš„å®šä½å’Œè®¾è®¡åœ¨è§£å†³äº†å¹³å°å›¢é˜Ÿçš„å¤§é—®é¢˜ä¹‹åï¼Œå´ä¹Ÿä¸ºç”¨æˆ·ä»¬å¸¦æ¥äº†æŒ‘æˆ˜å’Œå›°æ‰°ã€‚æ¯”å¦‚ï¼Œå¤ªå¤šçš„ç”¨æˆ·éƒ½åœ¨æŠ±æ€¨ Kubernetes â€œå¤ªå¤æ‚äº†â€ã€‚ç©¶å…¶åŸå› ï¼Œå…¶å®åœ¨äº Kubernetes ä¸­çš„æ ¸å¿ƒæ¦‚å¿µä¸ä½“ç³»ï¼Œå¦‚ï¼šPodã€sidecarã€Serviceã€èµ„æºç®¡ç†ã€è°ƒåº¦ç®—æ³•å’Œ CRD ç­‰ç­‰ï¼Œä¸»è¦æ˜¯é¢å‘å¹³å°å›¢é˜Ÿè€Œéæœ€ç»ˆç”¨æˆ·è®¾è®¡çš„ã€‚ç¼ºä¹é¢å‘ç”¨æˆ·çš„è®¾è®¡ä¸ä»…å¸¦æ¥äº†é™¡å³­çš„å­¦ä¹ æ›²çº¿ï¼Œå½±å“äº†ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒï¼Œæ‹–æ…¢äº†ç ”å‘æ•ˆèƒ½ï¼Œç”šè‡³åœ¨å¾ˆå¤šæƒ…å†µä¸‹è¿˜ä¼šå¼•å‘é”™è¯¯æ“ä½œä¹ƒè‡³ç”Ÿäº§æ•…éšœï¼ˆæ¯•ç«Ÿä¸å¯èƒ½æ¯ä¸ªä¸šåŠ¡å¼€å‘äººå‘˜éƒ½æ˜¯ Kubernetes ä¸“å®¶ï¼‰ã€‚</p><p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨äº‘åŸç”Ÿç”Ÿæ€ä¸­ï¼Œå‡ ä¹æ¯ä¸€ä¸ªå¹³å°å›¢é˜Ÿéƒ½ä¼šåŸºäº Kubernetes æ„å»ºä¸€ä¸ªä¸Šå±‚å¹³å°ç»™ç”¨æˆ·ä½¿ç”¨ã€‚æœ€ç®€å•çš„ä¹Ÿä¼šç»™ Kubernetes åšä¸€ä¸ªå›¾å½¢ç•Œé¢ï¼Œç¨å¾®æ­£å¼ä¸€äº›çš„åˆ™å¾€å¾€ä¼šåŸºäº Kubernetes å¼€å‘ä¸€ä¸ªç±» PaaS å¹³å°æ¥æ»¡è¶³è‡ªå·±çš„éœ€æ±‚ã€‚ç†è®ºä¸Šè®²ï¼Œåœ¨ Kubernetes ç”Ÿæ€ä¸­å„ç§èƒ½åŠ›å·²ç»éå¸¸ä¸°å¯Œçš„ä»Šå¤©ï¼Œå¼€å‘ä¸€ä¸ªç±» PaaS å¹³å°åº”è¯¥æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ã€‚</p><p>ç„¶è€Œç°å®å´å¾€å¾€ä¸å°½å¦‚äººæ„ã€‚åœ¨å¤§é‡çš„ç¤¾åŒºè®¿è°ˆå½“ä¸­ï¼Œæˆ‘ä»¬å‘ç°åœ¨äº‘åŸç”ŸæŠ€æœ¯æå¤§æ™®åŠçš„ä»Šå¤©ï¼ŒåŸºäº Kubernetes æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€ç”¨æˆ·å‹å¥½çš„ä¸Šå±‚åº”ç”¨å¹³å°ï¼Œä¾ç„¶æ˜¯ä¸­å¤§å‹å…¬å¸ä»¬çš„â€œä¸“åˆ©â€ã€‚è¿™é‡Œçš„åŸå› åœ¨äºï¼š</p><blockquote><p>Kubernetes ç”Ÿæ€æœ¬èº«çš„èƒ½åŠ›æ± å›ºç„¶ä¸°å¯Œï¼Œä½†æ˜¯ç¤¾åŒºé‡Œå´å¹¶æ²¡æœ‰ä¸€ä¸ªå¯æ‰©å±•çš„ã€æ–¹ä¾¿å¿«æ·çš„æ–¹å¼ï¼Œèƒ½å¤Ÿå¸®åŠ©å¹³å°å›¢é˜ŸæŠŠè¿™äº›èƒ½åŠ›å¿«é€Ÿâ€œç»„è£…â€æˆé¢å‘æœ€ç»ˆç”¨æˆ·çš„åŠŸèƒ½ï¼ˆFeatureï¼‰ã€‚</p></blockquote><p>è¿™ç§å›°å¢ƒå¸¦æ¥çš„ç»“æœï¼Œå°±æ˜¯å°½ç®¡å¤§å®¶ä»Šå¤©éƒ½åœ¨åŸºäº Kubernetes åœ¨æ„å»ºä¸Šå±‚åº”ç”¨å¹³å°ï¼Œä½†è¿™äº›å¹³å°æœ¬è´¨ä¸Šå´å¹¶ä¸èƒ½å¤Ÿä¸ Kubernetes ç”Ÿæ€å®Œå…¨æ‰“é€šï¼Œè€Œéƒ½å˜æˆä¸€ä¸ªåˆä¸€ä¸ªçš„å‚ç›´â€œçƒŸå›±â€ã€‚</p><p>åœ¨å¼€æºç¤¾åŒºä¸­ï¼Œè¿™ä¸ªé—®é¢˜ä¼šæ›´åŠ æ˜æ˜¾ã€‚åœ¨ä»Šå¤©çš„ Kubernetes ç¤¾åŒºä¸­ï¼Œä¸ä¹å„ç§â€œé¢å‘ç”¨æˆ·â€ã€â€œé¢å‘åº”ç”¨â€çš„ Kubernetes ä¸Šå±‚ç³»ç»Ÿã€‚ä½†æ­£å¦‚å‰æ–‡æ‰€è¿°ï¼Œè¿™äº›å¹³å°éƒ½æ— ä¸€ä¾‹å¤–çš„å¼•å…¥äº†è‡ªå·±çš„ä¸“å±ä¸Šå±‚æŠ½è±¡ã€ç”¨æˆ·ç•Œé¢å’Œæ’ä»¶æœºåˆ¶ã€‚è¿™é‡Œæœ€å…¸å‹çš„ä¾‹å­åŒ…æ‹¬ç»å…¸ PaaS é¡¹ç›®æ¯”å¦‚ Cloud Foundryï¼Œä¹ŸåŒ…æ‹¬å„ç§ Serverless å¹³å°ã€‚ä½œä¸ºä¸€ä¸ªå…¬å¸çš„å¹³å°å›¢é˜Ÿï¼Œæˆ‘ä»¬å®é™…ä¸Šåªæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šè¦ä¹ˆæŠŠè‡ªå·±å±€é™åœ¨æŸç§å‚ç›´çš„åœºæ™¯ä¸­æ¥é€‚é…å’Œé‡‡çº³æŸä¸ªå¼€æºä¸Šå±‚å¹³å°é¡¹ç›®ï¼›è¦ä¹ˆå°±åªèƒ½è‡ªç ”ä¸€ä¸ªç¬¦åˆè‡ªå·±è¯‰æ±‚çš„ä¸Šå±‚å¹³å°å¹¶ä¸”é€ æ— æ•°ä¸ªç¤¾åŒºä¸­å·²ç»å­˜åœ¨çš„â€œè½®å­â€ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰â€ç¬¬ä¸‰ç§é€‰æ‹©â€èƒ½å¤Ÿè®©å¹³å°å›¢é˜Ÿåœ¨ä¸é€ è½®å­ã€å®Œå…¨æ‰“é€š Kubernetes ç”Ÿæ€çš„å‰æä¸‹ï¼Œè½»æ¾çš„æ„å»ºé¢å‘ç”¨æˆ·çš„ä¸Šå±‚å¹³å°å‘¢ï¼Ÿ</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Ÿ"></a>KubeVela å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Ÿ<a class="hash-link" href="#kubevela-å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Ÿ" title="Direct link to heading">#</a></h2><p>KubeVela é¡¹ç›®çš„åˆ›ç«‹åˆè¡·ï¼Œå°±æ˜¯ä»¥ä¸€ä¸ªç»Ÿä¸€çš„æ–¹å¼åŒæ—¶è§£å†³ä¸Šè¿°æœ€ç»ˆç”¨æˆ·ä¸å¹³å°å›¢é˜Ÿæ‰€é¢ä¸´çš„å›°å¢ƒã€‚è¿™ä¹Ÿæ˜¯ä¸ºä½•åœ¨è®¾è®¡ä¸­ï¼ŒKubeVela å¯¹æœ€ç»ˆç”¨æˆ·å’Œå¹³å°å›¢é˜Ÿè¿™ä¸¤ç§ç¾¤ä½“è¿›è¡Œäº†å•ç‹¬çš„ç”»åƒï¼Œä»¥æ»¡è¶³ä»–ä»¬ä¸åŒçš„è¯‰æ±‚ã€‚</p><p>ç”±äº KubeVela é»˜è®¤çš„åŠŸèƒ½é›†ä¸â€œHerokuâ€ç±»ä¼¼ï¼ˆå³ï¼šä¸»è¦é¢å‘åº”ç”¨å¼€å‘äººå‘˜ï¼‰ï¼Œæ‰€ä»¥åœ¨ä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¼šä»¥åº”ç”¨å¼€å‘äººå‘˜æˆ–è€…å¼€å‘è€…æ¥ä»£æ›¿æœ€ç»ˆç”¨æˆ·ã€‚ä½†æˆ‘ä»¬å¾ˆå¿«ä¹Ÿä¼šè®²åˆ°ï¼ŒKubeVela é‡Œçš„æ¯ä¸€ä¸ªåŠŸèƒ½ï¼Œéƒ½æ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œä½œä¸ºå¹³å°å›¢é˜Ÿï¼Œä½ å¯ä»¥è½»æ¾åœ°â€œå¸è½½â€å®ƒçš„æ‰€æœ‰å†…ç½®èƒ½åŠ›ã€ç„¶åâ€œå®‰è£…â€è‡ªå·±éœ€è¦çš„ä»»ä½•ç¤¾åŒºèƒ½åŠ›ï¼Œè®© KubeVela å˜æˆä¸€ä¸ªå®Œå…¨ä¸ä¸€æ ·çš„ç³»ç»Ÿã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-ç”¨æˆ·çœ¼ä¸­çš„-kubevela"></a>1. ç”¨æˆ·çœ¼ä¸­çš„ KubeVela<a class="hash-link" href="#1-ç”¨æˆ·çœ¼ä¸­çš„-kubevela" title="Direct link to heading">#</a></h3><p>å‰é¢å·²ç»æåˆ°ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒKubeVela æ˜¯ä¸€ä¸ªç®€å•ã€æ˜“ç”¨ã€åˆé«˜å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨ç®¡ç†å·¥å…·ï¼Œå®ƒå¯ä»¥è®©å¼€å‘è€…ä»¥æä½çš„å¿ƒæ™ºè´Ÿæ‹…å’Œä¸Šæ‰‹æˆæœ¬åœ¨ Kubernetes ä¸Šå®šä¹‰ä¸éƒ¨ç½²åº”ç”¨ã€‚è€Œå…³äºæ•´ä¸ªç³»ç»Ÿçš„ä½¿ç”¨ï¼Œå¼€å‘è€…åªéœ€è¦ç¼–å†™ä¸€ä¸ª docker-compose é£æ ¼åº”ç”¨æè¿°æ–‡ä»¶ Appfile å³å¯ï¼Œä¸éœ€è¦æ¥è§¦å’Œå­¦ä¹ ä»»ä½• Kubernetes å±‚çš„ç›¸å…³ç»†èŠ‚ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1ï¼‰ä¸€ä¸ª-appfile-ç¤ºä¾‹"></a>1ï¼‰ä¸€ä¸ª Appfile ç¤ºä¾‹<a class="hash-link" href="#1ï¼‰ä¸€ä¸ª-appfile-ç¤ºä¾‹" title="Direct link to heading">#</a></h4><p>åœ¨ä¸‹è¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†ä¸€ä¸ªå«åš vela.yaml çš„ Appfile æ”¾åœ¨ä½ çš„åº”ç”¨ä»£ç ç›®å½•ä¸­ï¼ˆæ¯”å¦‚åº”ç”¨çš„ GitHub Repoï¼‰ã€‚è¿™ä¸ª Appfile å®šä¹‰äº†å¦‚ä½•å°†è¿™ä¸ªåº”ç”¨ç¼–è¯‘æˆ Docker é•œåƒï¼Œå¦‚ä½•å°†é•œåƒéƒ¨ç½²åˆ° Kubernetesï¼Œå¦‚ä½•é…ç½®å¤–ç•Œè®¿é—®åº”ç”¨çš„è·¯ç”±å’ŒåŸŸåï¼Œåˆå¦‚ä½•è®© Kubernetes è‡ªåŠ¨æ ¹æ® CPU ä½¿ç”¨é‡æ¥æ°´å¹³æ‰©å±•è¿™ä¸ªåº”ç”¨ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> testapp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">express-server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> oamdev/testapp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">docker</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Dockerfile</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">contrxt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> .</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;node&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;server.js&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.01&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">route</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> example.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">rules</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /testapp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">rewriteTarget</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">autoscale</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">min</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">cpuPercent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">5</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>åªè¦æœ‰äº†è¿™ä¸ª 20 è¡Œçš„é…ç½®æ–‡ä»¶ï¼Œä½ æ¥ä¸‹æ¥å”¯ä¸€éœ€è¦çš„äº‹æƒ…å°±æ˜¯ $ vela upï¼Œè¿™ä¸ªåº”ç”¨å°±ä¼šè¢«éƒ¨ç½²åˆ° Kubernetes ä¸­ç„¶åè¢«å¤–ç•Œä»¥ <a href="https://example.com/testapp" target="_blank" rel="noopener noreferrer">https://example.com/testapp</a> çš„æ–¹å¼è®¿é—®åˆ°ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2ï¼‰appfile-æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"></a>2ï¼‰Appfile æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ<a class="hash-link" href="#2ï¼‰appfile-æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ" title="Direct link to heading">#</a></h4><p>åœ¨ KubeVela çš„ Appfile èƒŒåï¼Œæœ‰ç€éå¸¸ç²¾å¦™çš„è®¾è®¡ã€‚é¦–å…ˆéœ€è¦æŒ‡å‡ºçš„å°±æ˜¯ï¼Œ<strong>è¿™ä¸ª Appfile æ˜¯æ²¡æœ‰å›ºå®šçš„ Schema çš„</strong>ã€‚</p><p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè¿™ä¸ª Appfile é‡Œé¢ä½ èƒ½å¤Ÿå¡«å†™çš„æ¯ä¸€ä¸ªå­—æ®µï¼Œéƒ½æ˜¯ç›´æ¥å–å†³äºå½“å‰å¹³å°ä¸­æœ‰å“ªäº›å·¥ä½œè´Ÿè½½ç±»å‹ï¼ˆWorkload Typesï¼‰å’Œåº”ç”¨ç‰¹å¾ï¼ˆTraitsï¼‰æ˜¯å¯ç”¨çš„ã€‚è€Œç†Ÿæ‚‰ OAM çš„åŒå­¦éƒ½çŸ¥é“ï¼Œè¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œæ­£æ˜¯ OAM è§„èŒƒçš„æ ¸å¿ƒå†…å®¹ï¼Œå…¶ä¸­ï¼š</p><ul><li><p><a href="https://kubevela.io/#/en/concepts?id=workload-type-amp-trait" target="_blank" rel="noopener noreferrer">å·¥ä½œè´Ÿè½½ç±»å‹ï¼ˆWorkload Typeï¼‰</a>ï¼Œå®šä¹‰çš„æ˜¯åº•å±‚åŸºç¡€è®¾æ–½å¦‚ä½•è¿è¡Œè¿™ä¸ªåº”ç”¨ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å£°æ˜ï¼šåå« testapp çš„åº”ç”¨ä¼šå¯åŠ¨ä¸€ä¸ªç±»å‹ä¸ºâ€œåœ¨çº¿ Web æœåŠ¡ï¼ˆWeb Serviceï¼‰â€ çš„å·¥ä½œè´Ÿè½½ï¼Œå…¶å®ä¾‹çš„åå­—æ˜¯ express-serverã€‚</p></li><li><p><a href="https://kubevela.io/#/en/concepts?id=workload-type-amp-trait" target="_blank" rel="noopener noreferrer">åº”ç”¨ç‰¹å¾ï¼ˆTraitsï¼‰</a>ï¼Œåˆ™ä¸ºå·¥ä½œè´Ÿè½½å®ä¾‹åŠ ä¸Šäº†è¿ç»´æ—¶é…ç½®ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª Route Trait æ¥æè¿°åº”ç”¨å¦‚ä½•è¢«ä»å¤–ç•Œè®¿é—®ï¼Œä»¥åŠä¸€ä¸ª Autoscale Trait æ¥æè¿°åº”ç”¨å¦‚ä½•æ ¹æ® CPU ä½¿ç”¨é‡è¿›è¡Œè‡ªåŠ¨çš„æ°´å¹³æ‰©å®¹ã€‚</p></li></ul><p>è€Œæ­£æ˜¯åŸºäºè¿™ç§æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œè¿™ä¸ª Appfile æœ¬èº«æ˜¯é«˜åº¦å¯æ‰©å±•çš„ã€‚å½“ä»»ä½•ä¸€ä¸ªæ–°çš„ Workload Type æˆ–è€… Trait è¢«å®‰è£…åˆ°å¹³å°åï¼Œç”¨æˆ·å°±å¯ä»¥ç«‹åˆ»åœ¨ Appfile é‡Œå£°æ˜ä½¿ç”¨è¿™ä¸ªæ–°å¢çš„èƒ½åŠ›ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚åé¢å¹³å°å›¢é˜Ÿæ–°å¼€å‘äº†ä¸€ä¸ªç”¨æ¥é…ç½®åº”ç”¨ç›‘æ§å±æ€§çš„è¿ç»´ä¾§èƒ½åŠ›ï¼Œå«åš Metricsã€‚é‚£ä¹ˆåªéœ€è¦ä¸¾æ‰‹ä¹‹æï¼Œç”¨æˆ·å°±å¯ä»¥ç«‹åˆ»ä½¿ç”¨ $ vela show metrics å‘½ä»¤æŸ¥çœ‹è¿™ä¸ªæ–°å¢èƒ½åŠ›çš„è¯¦æƒ…ï¼Œå¹¶ä¸”åœ¨ Appfile ä¸­ä½¿ç”¨å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> testapp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">express-server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> webservice</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> oamdev/testapp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">v1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">docker</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Dockerfile</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">contrxt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> .</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;node&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;server.js&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0.01&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">route</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> example.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">rules</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /testapp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token key atrule">rewriteTarget</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> /</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">autoscale</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">min</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">cpuPercent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">metrices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/metrics&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">scheme</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ç§ç®€å•å‹å¥½ã€åˆé«˜åº¦æ•æ·çš„ä½¿ç”¨ä½“éªŒï¼Œæ­£æ˜¯ KubeVela åœ¨æœ€ç»ˆç”¨æˆ·ä¾§æä¾›çš„ä¸»è¦ä½“æ„Ÿã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3ï¼‰vela-up-å‘½ä»¤"></a>3ï¼‰Vela Up å‘½ä»¤<a class="hash-link" href="#3ï¼‰vela-up-å‘½ä»¤" title="Direct link to heading">#</a></h4><p>å‰é¢æåˆ°ï¼Œä¸€æ—¦ Appfile å‡†å¤‡å¥½ï¼Œå¼€å‘è€…åªéœ€è¦ä¸€å¥ vela up å‘½ä»¤å°±å¯ä»¥æŠŠæ•´ä¸ªåº”ç”¨è¿åŒå®ƒçš„è¿ç»´ç‰¹å¾éƒ¨ç½²åˆ° Kubernetes ä¸­ã€‚éƒ¨ç½²æˆåŠŸåï¼Œä½ å¯ä»¥ä½¿ç”¨ vela status æ¥æŸ¥çœ‹æ•´ä¸ªåº”ç”¨çš„è¯¦æƒ…ï¼ŒåŒ…æ‹¬å¦‚ä½•è®¿é—®è¿™ä¸ªåº”ç”¨ã€‚</p><p><img src="https://tvax2.sinaimg.cn/large/ad5fbf65gy1glf9pyhr42j20la0kiafn.jpg"></p><p>é€šè¿‡ KubeVela éƒ¨ç½²çš„åº”ç”¨ä¼šè¢«è‡ªåŠ¨è®¾ç½®å¥½è®¿é—® URLï¼ˆä»¥åŠä¸åŒç‰ˆæœ¬å¯¹åº”çš„ä¸åŒ URLï¼‰ï¼Œå¹¶ä¸”ä¼šç”± cert-manager ç”Ÿæˆå¥½è¯ä¹¦ã€‚ä¸æ­¤åŒæ—¶ï¼ŒKubeVela è¿˜æä¾›äº†ä¸€ç³»åˆ—è¾…åŠ©å‘½ä»¤ï¼ˆæ¯”å¦‚ï¼švela logs å’Œ vela execï¼‰æ¥å¸®åŠ©ä½ åœ¨æ— éœ€æˆä¸º Kubernetes ä¸“å®¶çš„æƒ…å†µä¸‹æ›´å¥½åœ°ç®¡ç†å’Œè°ƒè¯•ä½ çš„åº”ç”¨ã€‚å¦‚æœä½ å¯¹ä¸Šè¿°ç”± KubeVela å¸¦æ¥çš„å¼€å‘è€…ä½“éªŒæ„Ÿå…´è¶£çš„è¯ï¼Œæ¬¢è¿å‰å¾€ KubeVela é¡¹ç›®çš„ç”¨æˆ·ä½¿ç”¨æ–‡æ¡£æ¥äº†è§£æ›´å¤šã€‚</p><p>è€Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦åˆ‡æ¢ä¸€ä¸‹è§†è§’ï¼Œæ„Ÿå—ä¸€ä¸‹å¹³å°å›¢é˜Ÿçœ¼ä¸­çš„ KubeVela åˆæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-å¹³å°å·¥ç¨‹å¸ˆçœ¼ä¸­çš„-kubevela"></a>2. å¹³å°å·¥ç¨‹å¸ˆçœ¼ä¸­çš„ KubeVela<a class="hash-link" href="#2-å¹³å°å·¥ç¨‹å¸ˆçœ¼ä¸­çš„-kubevela" title="Direct link to heading">#</a></h3><p>å®é™…ä¸Šï¼Œå‰é¢ä»‹ç»åˆ°çš„æ‰€æœ‰å¼€å‘è€…ä¾§ä½“éªŒï¼Œéƒ½ç¦»ä¸å¼€ KubeVela åœ¨å¹³å°ä¾§è¿›è¡Œçš„å„ç§åˆ›æ–°æ€§è®¾è®¡ä¸å®ç°ã€‚ä¹Ÿæ­£æ˜¯è¿™äº›è®¾è®¡çš„å­˜åœ¨ï¼Œæ‰ä½¿å¾— KubeVela ä¸æ˜¯ä¸€ä¸ªç®€å•çš„ PaaS æˆ–è€… Serverlessï¼Œ<strong>è€Œæ˜¯ä¸€ä¸ªå¯ä»¥ç”±å¹³å°å·¥ç¨‹å¸ˆæ‰©å±•æˆä»»æ„å‚ç›´ç³»ç»Ÿçš„äº‘åŸç”Ÿå¹³å°å†…æ ¸</strong>ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒKubeVela ä¸ºå¹³å°å·¥ç¨‹å¸ˆæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼Œä½¿å¾—åŸºäº Kubernetes æ„å»ºä¸Šè¿°é¢å‘ç”¨æˆ·çš„äº‘åŸç”Ÿå¹³å°ä»â€œé˜³æ˜¥ç™½é›ªâ€å˜æˆäº†â€œå°èœä¸€ç¢Ÿâ€ï¼š</p><p><strong>ç¬¬ä¸€ï¼šä»¥åº”ç”¨ä¸ºä¸­å¿ƒ</strong>ã€‚åœ¨ Appfile èƒŒåï¼Œå…¶å®å°±æ˜¯â€œåº”ç”¨â€è¿™ä¸ªæ¦‚å¿µï¼Œå®ƒæ˜¯åŸºäº OAM æ¨¡å‹å®ç°çš„ã€‚é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼ŒKubeVela è®©â€œåº”ç”¨â€è¿™ä¸ªæ¦‚å¿µæˆä¸ºäº†æ•´ä¸ªå¹³å°å¯¹ç”¨æˆ·æš´éœ²çš„æ ¸å¿ƒ APIã€‚KubeVela ä¸­çš„æ‰€æœ‰èƒ½åŠ›ï¼Œéƒ½æ˜¯å›´ç»•ç€â€œåº”ç”¨â€å±•å¼€çš„ã€‚è¿™æ­£æ˜¯ä¸ºä½•åŸºäº KubeVela æ‰©å±•å’Œæ„å»ºå‡ºæ¥çš„å¹³å°ï¼Œå¤©ç„¶æ˜¯ç”¨æˆ·å‹å¥½çš„ï¼šå¯¹äºä¸€ä¸ªå¼€å‘è€…æ¥è¯´ï¼Œä»–åªå…³å¿ƒâ€œåº”ç”¨â€ï¼Œè€Œä¸æ˜¯å®¹å™¨æˆ–è€… Kubernetesï¼›è€Œ KubeVela ä¼šç¡®ä¿æ„å»ºæ•´ä¸ªå¹³å°çš„è¿‡ç¨‹ï¼Œä¹Ÿåªä¸åº”ç”¨å±‚çš„éœ€æ±‚æœ‰å…³ã€‚</p><p><strong>ç¬¬äºŒï¼šKubernetes åŸç”Ÿçš„é«˜å¯æ‰©å±•æ€§</strong>ã€‚åœ¨å‰é¢æˆ‘ä»¬å·²ç»æåˆ°è¿‡ï¼ŒAppfile æ˜¯ä¸€ä¸ªç”± Workload Type å’Œ Trait ç»„æˆçš„ã€å®Œå…¨æ¨¡å—åŒ–çš„å¯¹è±¡ã€‚è€Œ OAM æ¨¡å‹çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯ä»»æ„ä¸€ä¸ª Kubernetes API èµ„æºï¼Œéƒ½å¯ä»¥ç›´æ¥åŸºäº Kubernetes çš„ CRD å‘ç°æœºåˆ¶æ³¨å†Œä¸ºä¸€ä¸ª Workload Type æˆ–è€… Traitã€‚è¿™ç§å¯æ‰©å±•æ€§ï¼Œä½¿å¾— KubeVela å¹¶ä¸éœ€è¦è®¾è®¡ä»»ä½•â€œæ’ä»¶ç³»ç»Ÿâ€ï¼š<strong>KubeVela é‡Œçš„æ¯ä¸€ä¸ªèƒ½åŠ›ï¼Œéƒ½æ˜¯æ’ä»¶ï¼Œè€Œæ•´ä¸ª Kubernetes ç¤¾åŒºï¼Œå°±æ˜¯ KubeVela åŸç”Ÿçš„æ’ä»¶ä¸­å¿ƒ</strong>ã€‚</p><p><strong>ç¬¬ä¸‰ï¼šç®€å•å‹å¥½ä½†é«˜åº¦å¯æ‰©å±•çš„ç”¨æˆ·ä¾§æŠ½è±¡ä½“ç³»</strong>ã€‚åœ¨äº†è§£äº† Appfile ä¹‹åï¼Œä½ å¯èƒ½å·²ç»å¯¹è¿™ä¸ªå¯¹è±¡çš„å®ç°æ–¹å¼äº§ç”Ÿäº†å¥½å¥‡ã€‚å®é™…ä¸Šï¼ŒKubeVela ä¸­å¹¶ä¸æ˜¯ç®€å•çš„å®ç°äº†ä¸€ä¸ª Appfileã€‚åœ¨å¹³å°å±‚ï¼ŒKubeVela åœ¨ OAM æ¨¡å‹å±‚å®ç°ä¸­é›†æˆäº†CUELang è¿™ç§ç®€æ´å¼ºå¤§çš„æ¨¡æ¿è¯­è¨€ï¼Œä»è€Œä¸ºå¹³å°å·¥ç¨‹å¸ˆåŸºäº Kubernetes API å¯¹è±¡å®šä¹‰ç”¨æˆ·ä¾§æŠ½è±¡ï¼ˆå³ï¼šâ€œæœ€åä¸€å…¬é‡Œâ€æŠ½è±¡ï¼‰æä¾›äº†ä¸€ä¸ªæ ‡å‡†ã€é€šç”¨çš„é…ç½®å·¥å…·ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå¹³å°å·¥ç¨‹å¸ˆæˆ–è€…ç³»ç»Ÿç®¡ç†å‘˜ï¼Œå¯ä»¥éšæ—¶éšåœ°çš„æ¯ä¸ªèƒ½åŠ›å¯¹åº”çš„ CUE æ¨¡æ¿è¿›è¡Œä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸€æ—¦æäº¤åˆ° Kubernetesï¼Œç”¨æˆ·åœ¨ Appfile é‡Œå°±å¯ä»¥ç«‹åˆ»ä½¿ç”¨åˆ°æ–°çš„æŠ½è±¡ï¼Œä¸éœ€è¦é‡æ–°éƒ¨ç½²æˆ–è€…å®‰è£… KubeVelaã€‚</p><p>åœ¨å…·ä½“å®ç°å±‚ï¼ŒKubeVela æ˜¯åŸºäº OAM Kubernetes Runtime æ„å»ºçš„ï¼ŒåŒæ—¶é‡‡ç”¨ KEDA ï¼ŒFlaggerï¼ŒPrometheus ç­‰ç”Ÿæ€é¡¹ç›®ä½œä¸º Trait çš„èƒŒåçš„ä¾èµ–ã€‚å½“ç„¶ï¼Œè¿™äº›ä¾èµ–åªæ˜¯ KubeVela çš„é€‰å‹ï¼Œä½ å¯ä»¥éšæ—¶ä¸º KubeVela å®šåˆ¶å’Œå®‰è£…ä½ å–œæ¬¢çš„ä»»ä½•èƒ½åŠ›ä½œä¸º Workload Type æˆ–è€… Traitã€‚ç»¼åˆä»¥ä¸Šè®²è§£ï¼ŒKubeVela é¡¹ç›®çš„æ•´ä½“æ¶æ„ç”±<strong>ç”¨æˆ·ç•Œé¢å±‚ï¼Œæ¨¡å‹å±‚ï¼Œå’Œèƒ½åŠ›ç®¡ç†å±‚</strong>ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://tva2.sinaimg.cn/large/ad5fbf65gy1glf9sktkdxj20q00dsacl.jpg"></p><p>æœ‰äº† KubeVelaï¼Œå¹³å°å·¥ç¨‹å¸ˆç»ˆäºæ‹¥æœ‰äº†ä¸€ä¸ªå¯ä»¥æ–¹ä¾¿å¿«æ·åœ°å°†ä»»ä½•ä¸€ä¸ª Kubernetes ç¤¾åŒºèƒ½åŠ›å°è£…æŠ½è±¡æˆä¸€ä¸ªé¢å‘ç”¨æˆ·çš„ä¸Šå±‚å¹³å°ç‰¹æ€§çš„å¼ºå¤§å·¥å…·ã€‚è€Œä½œä¸ºè¿™ä¸ªå¹³å°çš„æœ€ç»ˆç”¨æˆ·ï¼Œç”¨æˆ·ä»¬åªéœ€è¦å­¦ä¹ è¿™äº›ä¸Šå±‚æŠ½è±¡ï¼Œåœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­æè¿°åº”ç”¨ï¼Œå°±å¯ä»¥ä¸€é”®äº¤ä»˜å‡ºå»ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-kubevela-vs-ç»å…¸-paas"></a>3. KubeVela VS ç»å…¸ PaaS<a class="hash-link" href="#3-kubevela-vs-ç»å…¸-paas" title="Direct link to heading">#</a></h3><p>å¾ˆå¤šäººå¯èƒ½ä¼šé—®ï¼ŒKubeVela è·Ÿç»å…¸ PaaS çš„ä¸»è¦åŒºåˆ«å’Œè”ç³»æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>äº‹å®ä¸Šï¼Œå¤§å¤šæ•°ç»å…¸ PaaS éƒ½èƒ½æä¾›å®Œæ•´çš„åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†åŠŸèƒ½ï¼ŒåŒæ—¶ä¹Ÿéå¸¸å…³æ³¨æä¾›ç®€å•å‹å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæå‡ç ”å‘æ•ˆèƒ½ã€‚åœ¨è¿™äº›ç‚¹ä¸Šï¼ŒKubeVela è·Ÿç»å…¸ PaaS çš„ç›®æ ‡ï¼Œæ˜¯éå¸¸ä¸€è‡´çš„ã€‚</p><p>ä½†å¦ä¸€æ–¹é¢ï¼Œç»å…¸ PaaS å¾€å¾€æ˜¯ä¸å¯æ‰©å±•çš„ï¼ˆæ¯”å¦‚ Rancher çš„ Rio é¡¹ç›®ï¼‰ï¼Œæˆ–è€…ä¼šå¼•å…¥å±äºè‡ªå·±çš„æ’ä»¶ç”Ÿæ€ï¼ˆå“ªæ€•è¿™ä¸ª PaaS æ˜¯å®Œå…¨åŸºäº Kubernetes æ„å»ºçš„ï¼‰ï¼Œä»¥æ­¤æ¥ç¡®ä¿å¹³å°æœ¬èº«çš„ç”¨æˆ·ä½“éªŒå’Œèƒ½åŠ›çš„å¯æ§åˆ¶æ€§ï¼ˆæ¯”å¦‚ Cloud Foundry æˆ–è€… Heroku çš„<a href="https://elements.heroku.com/addons" target="_blank" rel="noopener noreferrer">æ’ä»¶ä¸­å¿ƒ</a>ï¼‰ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒKubeVela çš„è®¾è®¡æ˜¯å®Œå…¨ä¸åŒçš„ã€‚KubeVela çš„ç›®æ ‡ï¼Œä»ä¸€å¼€å§‹å°±æ˜¯åˆ©ç”¨æ•´ä¸ª Kubernetes ç¤¾åŒºä½œä¸ºè‡ªå·±çš„â€œæ’ä»¶ä¸­å¿ƒâ€ï¼Œå¹¶ä¸”â€œæ•…æ„â€æŠŠå®ƒçš„æ¯ä¸€ä¸ªå†…ç½®èƒ½åŠ›éƒ½è®¾è®¡æˆæ˜¯ç‹¬ç«‹çš„ã€å¯æ’æ‹”çš„æ’ä»¶ã€‚è¿™ç§é«˜åº¦å¯æ‰©å±•çš„æ¨¡å‹ï¼ŒèƒŒåå…¶å®æœ‰ç€ç²¾å¯†çš„è®¾è®¡ä¸å®ç°ã€‚æ¯”å¦‚ï¼ŒKubeVela å¦‚ä½•ç¡®ä¿æŸä¸ªå®Œå…¨ç‹¬ç«‹çš„ Trait ä¸€å®šèƒ½å¤Ÿç»‘å®šäºæŸç§ Workload Typeï¼Ÿå¦‚ä½•æ£€æŸ¥è¿™äº›ç›¸äº’ç‹¬ç«‹çš„ Trait æ˜¯å¦å†²çªï¼Ÿè¿™äº›æŒ‘æˆ˜ï¼Œæ­£æ˜¯ Open Application Modelï¼ˆOAMï¼‰ä½œä¸º KubeVela æ¨¡å‹å±‚çš„èµ·åˆ°çš„å…³é”®ä½œç”¨ï¼Œä¸€è¨€ä»¥è”½ä¹‹ï¼šOAM æ˜¯ä¸€ä¸ªé«˜åº¦å¯æ‰©å±•çš„åº”ç”¨å®šä¹‰ä¸èƒ½åŠ›ç®¡ç†æ¨¡å‹ã€‚</p><p>KubeVela å’Œ OAM ç¤¾åŒºæ¬¢è¿å¤§å®¶è®¾è®¡å’Œåˆ¶ä½œä»»ä½• Workload Type å’Œ Trait çš„å®šä¹‰æ–‡ä»¶ã€‚åªè¦æŠŠå®ƒä»¬å­˜æ”¾åœ¨ GitHub ä¸Šï¼Œå…¨ä¸–ç•Œä»»ä½•ä¸€ä¸ª KubeVela ç”¨æˆ·å°±éƒ½å¯ä»¥åœ¨è‡ªå·±çš„ Appfile é‡Œä½¿ç”¨ä½ æ‰€è®¾è®¡çš„èƒ½åŠ›ã€‚å…·ä½“çš„æ–¹å¼ï¼Œè¯·å‚è€ƒ <code>$ vela cap</code> ï¼ˆå³ï¼šæ’ä»¶èƒ½åŠ›ç®¡ç†å‘½ä»¤ï¼‰çš„<a href="https://kubevela.io/#/en/developers/cap-center" target="_blank" rel="noopener noreferrer">ä½¿ç”¨æ–‡æ¡£</a>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="äº†è§£æ›´å¤š"></a>äº†è§£æ›´å¤š<a class="hash-link" href="#äº†è§£æ›´å¤š" title="Direct link to heading">#</a></h2><p>KubeVela é¡¹ç›®æ˜¯ OAM ç¤¾åŒºçš„å®˜æ–¹é¡¹ç›®ï¼Œæ—¨åœ¨å–ä»£åŸå…ˆçš„ Rudr é¡¹ç›®ã€‚ä¸è¿‡ï¼Œä¸ <a href="https://github.com/oam-dev/rudr" target="_blank" rel="noopener noreferrer">Rudr</a> ä¸»è¦ä½œä¸ºâ€œå‚è€ƒå®ç°â€çš„å®šä½ä¸åŒï¼ŒKubeVela æ—¢æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯ã€é¢å‘å…¨é‡åœºæ™¯çš„ OAM Kubernetes å®Œæ•´å®ç°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯é˜¿é‡Œäº‘ EDAS æœåŠ¡å’Œå†…éƒ¨å¤šä¸ªæ ¸å¿ƒ PaaS/Serverless ç”Ÿäº§ç³»ç»Ÿåº•å±‚çš„æ ¸å¿ƒç»„ä»¶ã€‚ æ­¤å¤–ï¼ŒKubeVela ä¸­ Apppfile çš„è®¾è®¡ï¼Œä¹Ÿæ˜¯ OAM ç¤¾åŒºåœ¨ OAM è§„èŒƒä¸­å³å°†å¼•å…¥çš„â€œé¢å‘ç”¨æˆ·ä¾§å¯¹è±¡â€çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚</p><p>å¦‚æœä½ æƒ³è¦æ›´å¥½çš„äº†è§£ KubeVela é¡¹ç›®ï¼Œæ¬¢è¿å‰å¾€å…¶å®˜æ–¹ç½‘ç«™ä¸Š<a href="https://kubevela.io/" target="_blank" rel="noopener noreferrer">å­¦ä¹ å…·ä½“çš„ç¤ºä¾‹å’Œæ‰‹å†Œ</a>ã€‚ä»¥ä¸‹ä¹Ÿæ˜¯ä¸€äº›éå¸¸å¥½çš„å­¦ä¹ å†…å®¹å’Œæ–¹å¼ï¼š</p><ul><li>å‰å¾€å­¦ä¹  <a href="https://kubevela.io/#/en/quick-start" target="_blank" rel="noopener noreferrer">KubeVela Quick Startï¼ˆæ–°æ‰‹æ•™ç¨‹ï¼‰</a>ï¼Œä¸€æ­¥æ­¥äº†è§£ KubeVela çš„ä½¿ç”¨æ–¹æ³•ã€‚</li><li>å‰å¾€ OAM ç¤¾åŒºæ·±å…¥äº¤æµå’Œåé¦ˆã€‚ä¸­æ–‡ï¼šé’‰é’‰ç¾¤ 23310022ï¼Œè‹±æ–‡ï¼š<a href="https://gitter.im/oam-dev/community" target="_blank" rel="noopener noreferrer">Gitter</a> å’Œ <a href="https://cloud-native.slack.com/archives/C01BLQ3HTJA" target="_blank" rel="noopener noreferrer">CNCF Slack</a>ã€‚</li><li>å°è¯•ä¸º <a href="https://kubevela.io/#/en/platform-engineers/trait" target="_blank" rel="noopener noreferrer">KubeVela æ·»åŠ æ¥è‡ªå¼€æºç¤¾åŒºçš„æ’ä»¶èƒ½åŠ›</a>ã€‚æ­¤å¤–ï¼Œå¦‚æœä½ æœ‰ä»»ä½•å…³äºæ‰©å±• KubeVela çš„å¥‡å¦™æƒ³æ³•ï¼Œæ¯”å¦‚ï¼ŒåŸºäº KubeVela å¼€å‘ä¸€ä¸ªè‡ªå·±çš„äº‘åŸç”Ÿæ•°æ®åº“ PaaS æˆ–è€… AI PaaSï¼Œæ¬¢è¿å‰å¾€ OAM ç¤¾åŒºé€šè¿‡ Issue æ¥è¿›è¡Œè®¨è®ºã€‚</li><li>ä¸º KubeVela è´¡çŒ®ä»£ç . KubeVela é¡¹ç›®æ˜¯ä¸€ä¸ªè¯ç”Ÿè‡ªäº‘åŸç”Ÿç¤¾åŒºçš„å¼€æºé¡¹ç›®ï¼ˆæ„Ÿè°¢æ¥è‡ª 8 å®¶ä¸åŒå…¬å¸çš„<a href="https://github.com/oam-dev/kubevela/blob/bbb2c527d96d3e1a0694e2f49b3d1d1168e72c53/OWNERS_ALIASES#L35" target="_blank" rel="noopener noreferrer">åˆå§‹è´¡çŒ®è€…</a>ï¼Œå¹¶ç‰¹åˆ«é¸£è°¢ KubeVela ç½‘ç«™çš„å‘èµ·è€… <a href="https://github.com/sunny0826" target="_blank" rel="noopener noreferrer">guoxudong</a>ï¼‰ã€‚ </li></ul><p><strong>KubeVela é¡¹ç›®çš„ç»´æŠ¤è€…ä¼šåœ¨é¡¹ç›®ç¨³å®šåï¼Œå³å°†æ•´ä¸ªé¡¹ç›®æ‰€æœ‰æƒæèµ ç»™ä¸­ç«‹å¼€æºåŸºé‡‘ä¼šã€‚</strong></p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kubevela">kubevela</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/zh/blog/kubevela-performance-test">KubeVela Performance Test - Managing Massive Applications</a></h2><div class="margin-vert--md"><time datetime="2021-09-05T14:52:55.776Z" class="blogPostDate_fNvV">2021å¹´9æœˆ5æ—¥ Â· é˜…è¯»éœ€è¦ 1 åˆ†é’Ÿ</time></div><div class="avatar margin-vert--md"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://kubevela.io/img/logo.svg" alt="Da Yin, Yang Song, Zhengxi Zhou and Jianbo Sun"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer">Da Yin, Yang Song, Zhengxi Zhou and Jianbo Sun</a></h4><small class="avatar__subtitle">KubeVela Team</small></div></div></header><div class="markdown"><p>As an application management and integration platform, KubeVela needs to handle thousands of applications in production scenario. To evaluate the performance of KubeVela, develop team has conducted performance tests based on simultated environments and demonstrated the capability of managing a large number of applications concurrently.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setup"></a>Setup<a class="hash-link" href="#setup" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-environment"></a>Cluster Environment<a class="hash-link" href="#cluster-environment" title="Direct link to heading">#</a></h3><p>Working with large clusters requires lots of resources, such as Machines, Network Bandwidth, Storages and many other devices. Therefore, KubeVela team adopts kubemark, an official tool provided by kubernetes, to simulate large clusters by mocking hundreds of kubelets. Each kubelet works like a real node except that they do not run real containers inside pods. The aim of KubeVela performance test mainly focus on whether KubeVela controller can manage thousands of applications effectively, instead of pulling images or executing commands inside pods. As a result, we only need to get resources hosting these fake nodes, also named as hollow-nodes.</p><p>We set up the Kubernetes clusters on Alibaba Cloud which includes 5 master nodes and 15 worker nodes. The master nodes wil host Kubernetes core components such as kube-apiserver and kube-controller-manager. The worker nodes need to run other pressure-test related componets, including monitoring tools, KubeVela controller and kubemark pods. Since the major target is to test the performance of KubeVela controller, we do not expect other components to be the bottleneck of the pressure test. To this end, both master nodes and worker nodes are equiped with 32 cores and 128 Gi memory. We use the combination of Prometheus, Loki and Grafana as the monitoring suites and grant them enough resources in avoid of crash caused by Out-of-Memory.</p><p>Notice that KubeVela controller and monitoring tools need to be placed on real nodes to function while all pods created during performance tests should be assigned to hollow-nodes correctly. To achieve that, we give different taints to hollow-nodes and real nodes, and add corresponding tolerations to different pods.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="application"></a>Application<a class="hash-link" href="#application" title="Direct link to heading">#</a></h3><p>To simulate real applications in production, we design an application template with 2 components and 5 functional traits, including</p><ul><li>1 webservice component<ul><li>a scaler trait setting its replica to 3</li><li>a sidecar trait attaching another container to each pod</li><li>an ingress trait generating one ingress instance and one service instance</li></ul></li><li>1 worker component<ul><li>a scaler trait also setting its replica to 3</li><li>a configmap trait generating a new configmap and attaching it to worker pods</li></ul></li></ul><p>In the following experiment, we test the performance of KubeVela controller managing 3,000 Applications (12,000 Pods in total) on 200 nodes. Applications are created in parallel at first, then kept running for a while, and finally deleted from the cluster. Each application will be reconciled multiple times with latencies and consumed resources recorded by monitoring tools.</p><blockquote><p>In practice, we also have another trait used for adding tolerations as described above.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubevela-controller"></a>KubeVela Controller<a class="hash-link" href="#kubevela-controller" title="Direct link to heading">#</a></h3><p>The KubeVela controller is set up with a group of recommendation configurations as follows</p><ul><li>Kubernetes Resource<ul><li>0.5 core CPU</li><li>1 Gi Memory</li><li>1 replica</li></ul></li><li>Program <ul><li>concurrent-reconciles=2 (The number of reconcile threads)</li><li>kube-api-qps=300 (The qps of kubernetes client used in controller)</li><li>kube-api-burst=500 (The burst of kubernetes client used in controller)</li><li>informer-re-sync-interval=20m (The interval of routine reconciles.)
We will analyze these settings in the below sections.</li></ul></li></ul><blockquote><p>To evaluate the performance of KubeVela Controller itself, we disabled the Ingress MutatingWebhook and Application ValidatingWebhook which is beyond the focus of this test but will affect the performance of KubeVela Controller by increasing the latency of creating/patching resources.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="experiments"></a>Experiments<a class="hash-link" href="#experiments" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creation"></a>Creation<a class="hash-link" href="#creation" title="Direct link to heading">#</a></h3><p>The creation of all 3,000 applications lasted 25min. Getting all pods running takes a bit longer time, which is out of the scope of KubeVela controller. </p><p>For each application creation, it will trigger three turns of reconciling. The usage of CPU will reach 100% in the late period of creation. The memory usage will increase as the number of applications rises. It reaches around 67% at the end of creation.</p><p><img alt="create-cpu" src="/zh/assets/images/create-cpu-50a2f951ca18219c47f86fc87861387a.png">
<img alt="create-memory" src="/zh/assets/images/create-memory-1d5a108aa88dca5b5233df07b975869f.png"></p><p>The average time of the first turn reconciling is relatively short since it only needs patch finalizer. The second and third turn reconciling contain full reconcile cycles and need more time to process. The following charts record the time consumptions of different period during reconciling applications. The average time is generally below 200ms while 99% of reconciles uses less than 800ms.</p><p><img alt="create-avg-time" src="/zh/assets/images/create-avg-time-c9096f848bacebb15879e354db90ad79.png">
<img alt="create-p99-time" src="/zh/assets/images/create-p99-time-6834848739195ef1a6836e8830a60940.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="regular-reconciles"></a>Regular Reconciles<a class="hash-link" href="#regular-reconciles" title="Direct link to heading">#</a></h3><p>After creation, applications are reconciled by controller every 20min. the monitoring of 8-hour reconcile process are displayed as below. The CPU usage will come up to 90% once reconcile happens routinely. The memory usage generally keeps a stable pattern, up to 75% memory usage.</p><p><img alt="med-cpu" src="/zh/assets/images/med-cpu-1ee6beebe2ddac70499b2fe0f1200346.png">
<img alt="med-memory" src="/zh/assets/images/med-memory-84ee70599fdfe10c539d31a8ffd011f3.png"></p><p>The average reconcile time is under 200ms while 99% are about 800ms~900ms. Each regular reconcile for all applications generally takes around 10min.</p><p><img alt="med-avg" src="/zh/assets/images/med-avg-71e81f42a57ba18fe977c1cb8f041e6f.png">
<img alt="med-p99" src="/zh/assets/images/med-p99-660473173a37679faf8f5c54a4668b7c.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deletion"></a>Deletion<a class="hash-link" href="#deletion" title="Direct link to heading">#</a></h3><p>The application deletion process is fast and low-resource consumptive. It takes less than 3min to delete all applications. However, notice that the deletion of resources managed by application usually takes longer time. This is because the cleanup of these resources (such as deployments or pods) are not directly controlled by the KubeVela controller. KubeVela controller takes charge of deleting their owner and cleanup them by triggering cascading deletion. In addition, each deletion is associated with two turns of reconcile where the second turn returns immediately when it fails to retrieve target applciation (since it is deleted).</p><p><img alt="del-cpu" src="/zh/assets/images/del-cpu-e20c033c8d55123b17d4daf25af8b0e1.png">
<img alt="del-memory" src="/zh/assets/images/del-memory-7185fe1f634f7bfede12924608db96f2.png">
<img alt="del-avg" src="/zh/assets/images/del-avg-b8c9b19de6d6472f5ad751ee5b13cd22.png">
<img alt="del-p99" src="/zh/assets/images/del-p99-c2efbbd508a210d006bbb511944ec547.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="analysis"></a>Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="number-of-applications"></a>Number of Applications<a class="hash-link" href="#number-of-applications" title="Direct link to heading">#</a></h3><p>The experiment displayed above demonstrates a classical scenario for KubeVela. Although 3,000 applications are successfully managed by the KubeVela controller in this case, it is strongly recommended to adopt a smaller number (such as 2,000) of applications with the above configuration for the following reasons:
The time and resource consumption is closely associated with the spec of applications. If a lot of users apply larger applications with more pods and more other resources, 3,000 applications might break the resource limit more easily.
The memory and CPU usage shown above is approching resource limits. If memory drains, the KubeVela controller will crash and restart. If high CPU usage maintains for a long time, it might cause a long waiting queue in KubeVela controller which further lead to longer response time for application changes.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configurations"></a>Configurations<a class="hash-link" href="#configurations" title="Direct link to heading">#</a></h3><p>There are several parameters users could config to adapt into their own scenario.
Using more replica for KubeVela controller do not scale up the ability of KubeVela controller. The leader election mechanism ensures that only one replica will work while others will wait. The aim of multi-replica is to support fast recovery when the working one crash. However, if the crash is caused by OOM, the recovery usually will not be able to fix that.
The number of qps and burst in the program configuration should be increased accordingly while scaling up KubeVela controller. These two parameters limit the capability for controller to send requests to apiserver.
Generally, in order to scale up KubeVela controller, scale up the resource limits and all the program parameters mentioned above (except the reconcile interval). If you have more applications to manage, add more memory. If you have higher operation frequency, add more CPU and threads, then increase qps and burst accordingly.
Longer reconcile interval allows more applications to handle, at the cost of longer time to fix potential underlying resource problems. For example, if one deployment managed by one application disappears, the routine reconciling can discover this problem and fix it.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="scaling-up"></a>Scaling Up<a class="hash-link" href="#scaling-up" title="Direct link to heading">#</a></h3><p>In addition to the experiment described above, we conducted another two experiment to test how well KubeVela controller can scale to larger clusters and more applications.</p><p>In a 500-node cluster, we tried to create 5,000 applications with the same spec described above, at the speed of 4 per second and lasted for around 21min. 1 core and 2 Gi memory are granted to KubeVela controller with the use of 4 concurrent reconcile threads. The kube-api-qps and kube-api-burst are raised to 500/800 correspondingly. All 30,000 pods successfully turn into Running phase. The time costs for each reconcile is similar to the previous experiment and CPU/Memory cost is not very high compared to the given resources. The regular reconciles for 5,000 applications takes 7~8 minutes, and no significant resource cost is observed. During this scaling, we found that the throughput of kube-apiserver starts to block the creation of application, as too many resources need to be created while applying applications.</p><p><img alt="std-cpu" src="/zh/assets/images/std-cpu-ffd81b9aa9f3f19744fe28d7f9817e73.png">
<img alt="std-memory" src="/zh/assets/images/std-memory-d0fb9771e7ab4d9588ef193424a76073.png"></p><p>Scaling up to 12,000 applications on 1,000 nodes is much harder than previous attempts. With the same creation speed, the apiserver will be flooded by lots of pod scheduling requests and finally start to drop application creation request. To overcome this difficulty, we divide the creation process of applications into several stage. Each stage only create 1,000~3,000 applications and the next stage will not begin until all pods are ready. With this strategy, we successfully create 12,000 applications, 24,000 deployments, 12,000 services, 12,000 ingress, 12,000 configmaps and 72,000 pods. The whole process takes about 30 hours. To hold this number of applications, KubeVela controller consumes 1.7 cores and 2.45 Gi memory. It takes about 12min to finish a full turn of regular reconciles for all 12,000 applications.</p><p><img alt="large-cpu" src="/zh/assets/images/large-cpu-d83276edbb15f8a396f27ea144625469.png">
<img alt="large-memory" src="/zh/assets/images/large-memory-360f435a8446f13a86246c19fad2f729.png">
<img alt="large-all" src="/zh/assets/images/large-all-8b83d8c79d4faf56ba67aa9594ce5eee.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="future"></a>Future<a class="hash-link" href="#future" title="Direct link to heading">#</a></h3><p>The performance test of KubeVela demonstrates its ability of managing thousands of applications with limited resource consumption. It can also scale up to over 10,000 applications on large clusters with 1,000 nodes. In addition, KubeVela team also conducted similar pressure test for non-deployment based applications such as CloneSet in OpenKruise (which is not enclosed in this report) and reach same conclusions. In the future, we will add more performance tests for more complex scenario like Workflow or MultiCluster.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/zh/blog/tags/kubevela">kubevela</a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">æ–‡æ¡£</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh/docs/install">å¿«é€Ÿå¼€å§‹</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/platform-engineers/overview">Platform Admin Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/end-user/application">End User Guide</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">ç¤¾åŒº</h4><ul class="footer__items"><li class="footer__item"><a href="https://slack.cncf.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">CNCF Slack ( #kubevela channel )</a></li><li class="footer__item"><a href="https://gitter.im/oam-dev/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/">é’‰é’‰ (23310022)</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">æ›´å¤š</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/oam-dev/kubevela" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/blog">åšå®¢</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <br>
        <strong>Â© KubeVela Authors 2021 | Documentation Distributed under <a herf="https://creativecommons.org/licenses/by/4.0">CC-BY-4.0</a> </strong> <strong>| Powered by <a href="https://www.netlify.com">Netlify</a></strong>
        <br>
      </div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.56bf16d5.js"></script>
<script src="/zh/assets/js/main.c258436b.js"></script>
</body>
</html>